<properties
	pageTitle="Администрирование мобильной службы из командной строки | Microsoft Azure"
	description="Узнайте, как с помощью программ командной строки создать и развернуть мобильную службу Azure, а также управлять ею."
	services="mobile-services"
	documentationCenter="Mobile"
	authors="ggailey777"
	manager="dwrede"
	editor=""/>

<tags
	ms.service="mobile-services"
	ms.workload="mobile"
	ms.tgt_pltfrm="NA"
	ms.devlang="multiple"
	ms.topic="article"
	ms.date="07/21/2016"
	ms.author="glenga"/>

# Автоматизация мобильных служб с помощью средств командной строки

[AZURE.INCLUDE [mobile-service-note-mobile-apps](../../includes/mobile-services-note-mobile-apps.md)]

&nbsp;


##Обзор

В этом разделе показано, как использовать средства командной строки Azure для автоматизации создания мобильных служб Azure и управления ими. В этом разделе показано, как установить и начать использовать средства командной строки для выполнения ключевых задач мобильных служб.

При объединении в один скрипт или пакетный файл эти отдельные команды автоматизируют процесс создания, проверки и удаления мобильной службы.

В этом разделе описывается набор общих задач администрирования, поддерживаемых средствами командной строки Azure. Дополнительные сведения см. в [документации средств командной строки Azure][reference-docs].

##Установка программ командной строки Azure

Следующий список содержит сведения по установке программ командной строки в зависимости от операционной системы:

* **Windows**: скачайте [установщик средств командной строки Azure][windows-installer]. Откройте загруженный MSI-файл и выполните установку.

* **Mac**: скачайте [установщик пакета SDK для Azure][mac-installer]. Откройте загруженный файл .pkg и выполните установку.

* **Linux**: установите последнюю версию [Node.js][nodejs-org] \(см. раздел [Установка Node.js через диспетчер пакетов][install-node-linux]), а затем выполните следующую команду:

	npm install azure-cli -g

Чтобы проверить правильность установки, введите `azure` в командной строке. Если установка прошла успешно, вы увидите список всех доступных команд `azure`.

##Загрузка и импорт параметров публикации

Чтобы начать работу, необходимо сначала загрузить и импортировать параметры публикации. Это позволит вам использовать средства для создания и управления службами Azure. Чтобы загрузить параметры публикации, используйте команду `account download`:

	azure account download

После этого откроется браузер по умолчанию и появится запрос на вход в классический портал Azure. После входа будет скачан файл `.publishsettings`. Запишите расположение сохраненного файла.

Затем импортируйте файл `.publishsettings`. Для этого выполните следующую команду и замените параметр `<path-to-settings-file>` на путь к файлу `.publishsettings`:

	azure account import <path-to-settings-file>

Все сведения, сохраненные командой <code>import</code>, можно удалить с помощью команды <code>account clear</code>:

	azure account clear

Чтобы просмотреть список параметров для команд `account`, используйте параметр `-help`:

	azure account -help

После импорта параметров публикации необходимо удалить файл `.publishsettings` из соображений безопасности. Дополнительные сведения см. в статье [Установка программ командной строки Azure для Mac и Linux]. Теперь вы можете приступить к созданию мобильных служб Azure и начать управлять ими с помощью командной строки или пакетных файлов.

##Создание мобильной службы

Средства командной строки можно использовать для создания нового экземпляра мобильной службы. При создании мобильной службы также создается экземпляр базы данных SQL на новом сервере.

Следующая команда создает новый экземпляр мобильной службы в вашей подписке, где `<service-name>` — имя новой мобильной службы, `<server-admin>` — имя для входа на новый сервер, а `<server-password>` — пароль к новому имени для входа:

	azure mobile create <service-name> <server-admin> <server-password>

Команда `mobile create` завершается ошибкой, если указанная мобильная служба существует. В скриптах автоматизации следует попытаться удалить мобильную службу, прежде чем попытаться создать ее еще раз.

##Перечисление существующих мобильных служб в подписке

> [AZURE.NOTE] Команды CLI, связанные со "списком" и "скриптом", работают только с сервером JavaScript.

Следующая команда возвращает список всех мобильных служб в подписке Azure:

	azure mobile list

Эта команда также показывает текущее состояние и URL-адрес каждой мобильной службы.

##Удаление существующей мобильной службы

Средства командной строки можно использовать для удаления существующей мобильной службы вместе со связанной базой данных SQL и сервером. Следующая команда удаляет мобильную службу, где `<service-name>` — имя мобильной службы, которую требуется удалить:

	azure mobile delete <service-name> -a -q

Если добавить параметры `-a` и `-q`, эта команда также удаляет базу данных SQL и сервер, используемые мобильной службой, без отображения запроса.

> [AZURE.NOTE] Если не указать параметр <code>-q</code> вместе с параметром <code>-a</code> или <code>-d</code>, выполнение приостанавливается и отображается запрос для выбора параметров удаления базы данных SQL. Используйте только параметр <code>-a</code>, если другие службы не используют базу данных или сервер. В противном случае используйте параметр <code>-d</code>, чтобы удалить только те данные, которые принадлежат удаляемой мобильной службе.

##Создание таблицы в мобильной службе

Следующая команда создает таблицу в указанной мобильной службе, где `<service-name>` — имя мобильной службы, а `<table-name>` — это имя создаваемой таблицы:

	azure mobile table create <service-name> <table-name>

Эта команда создает таблицу `application` с установленными по умолчанию разрешениями для операций с таблицей: `insert`, `read`, `update` и `delete`.

Следующая команда создает таблицу с общедоступным разрешением `read`, но разрешение `delete` предоставляется только администраторам:

	azure mobile table create <service-name> <table-name> -p read=public,delete=admin

В следующей таблице показано значение разрешения скрипта в сравнении со значением разрешения на [классическом портале Azure].

|Значение сценария|Значение портала| |========|========| |`public`|Все| |`application` (по умолчанию)|Все с ключом приложения| |`user`|Только прошедшие проверку пользователи| |`admin`|Только скрипты и администраторы|

Команда `mobile table create` завершается ошибкой, если указанная таблица существует. В скриптах автоматизации следует попытаться удалить таблицу, прежде чем попытаться создать ее еще раз.

##Перечисление существующих таблиц в мобильной службе

Следующая команда возвращает список всех таблиц в мобильной службе, где `<service-name>` — имя мобильной службы:

	azure mobile table list <service-name>

Эта команда также показывает число индексов в каждой таблице и число строк данных в таблице на текущий момент.

##Удаление существующей таблицы из мобильной службы

Следующая команда удаляет таблицу из указанной мобильной службы, где `<service-name>` — имя мобильной службы, а `<table-name>` — это имя удаляемой таблицы:

	azure mobile table delete <service-name> <table-name> -q

В скриптах автоматизации используйте параметр `-q`, чтобы удалить таблицу без отображения запроса на подтверждение, который блокирует выполнение.

##Регистрация скрипта для операции с таблицей

Следующая команда передает и регистрирует функцию для операции с таблицей, где `<service-name>` — имя мобильной службы, `<table-name>` — имя таблицы, а `<operation>` — одна из следующих операций с таблицей: `read`, `insert`, `update` или `delete`:

	azure mobile script upload <service-name> table/<table-name>.<operation>.js

Обратите внимание, что эта операция загружает файл JavaScript (JS) с локального компьютера. Имя файла должно состоять из имен таблицы и операции, а файл должен находиться во вложенной папке `table` относительно расположения, где выполняется команда. Например, следующая операция передает и регистрирует новый скрипт `insert`, который принадлежит таблице `TodoItems`:

	azure mobile script upload todolist table/todoitems.insert.js

Объявление функции в файле скрипта также должно соответствовать зарегистрированной табличной операции. Это значит, что для скрипта `insert` переданный скрипт содержит функцию со следующей сигнатурой:

	function insert(item, user, request) {
	    ...
	}

Дополнительные сведения о регистрации скриптов сценариев см. в [справочнике по серверным скриптам мобильных служб].

<!-- Anchors. -->
[Download and install the command-line tools]: #install
[Download and import publish settings]: #import
[Create a new mobile service]: #create-service
[Get the master key]: #get-master-key
[Create a new table]: #create-table
[Register a new table script]: #register-script
[Delete an existing table]: #delete-table
[Delete an existing mobile service]: #delete-service
[Test the mobile service]: #test-service
[List mobile services]: #list-services
[List tables]: #list-tables
[Next steps]: #next-steps

<!-- Images. -->











<!-- URLs. -->
[справочнике по серверным скриптам мобильных служб]: http://go.microsoft.com/fwlink/p?LinkId=262293

[классическом портале Azure]: https://manage.windowsazure.com/
[nodejs-org]: http://nodejs.org/
[install-node-linux]: https://github.com/joyent/node/wiki/Installing-Node.js-via-package-manager

[mac-installer]: http://go.microsoft.com/fwlink/p?LinkId=252249
[windows-installer]: http://go.microsoft.com/fwlink/p?LinkID=275464
[reference-docs]: http://azure.microsoft.com/documentation/articles/virtual-machines-command-line-tools/#Commands_to_manage_mobile_services
[Установка программ командной строки Azure для Mac и Linux]: http://go.microsoft.com/fwlink/p/?LinkId=275795

<!---HONumber=AcomDC_0727_2016-->