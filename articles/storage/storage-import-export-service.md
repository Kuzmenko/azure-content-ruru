<properties
	pageTitle="Использование службы экспорта и импорта для передачи данных BLOB-объектов в хранилище Microsoft Azure"
	description="Узнайте, как создавать задания импорта и экспорта на классическом портале Azure для передачи данных в хранилище BLOB-объектов."
	authors="renashahmsft"
	manager="aungoo"
	editor="tysonn"
	services="storage"
	documentationCenter=""/>

<tags
	ms.service="storage"
	ms.workload="storage"
	ms.tgt_pltfrm="na"
	ms.devlang="na"
	ms.topic="article"
	ms.date="09/21/2016"
	ms.author="renash;robinsh"/>


# Использование службы импорта и экспорта Azure для передачи данных в хранилище BLOB-объектов

## Обзор

Служба импорта и экспорта Azure позволяет безопасно переносить большие объемы данных в хранилище BLOB-объектов Azure, отправляя жесткие диски в центр обработки данных Azure. Кроме того, с ее помощью можно переносить данные из хранилища BLOB-объектов Azure на жесткие диски и передавать на локальный сайт. Служба пригодится в тех случаях, когда необходимо передать несколько терабайтов данных в Azure или из Azure, но использовать для этого сеть невозможно в связи с ограниченной пропускной способностью или высокой стоимостью трафика.

В целях защиты данных служба требует, чтобы жесткие диски кодировались с помощью ключа BitLocker. Служба поддерживает классические учетные записи хранения, присутствующие во всех регионах общедоступного Azure. Жесткие диски необходимо отправлять в одно из поддерживаемых расположений, указанных далее в этой статье.

В этой статье приводятся дополнительные сведения о службе импорта и экспорта Azure и рассказывается, как отправлять жесткие диски для копирования данных в хранилище и из хранилища BLOB-объектов Azure.

> [AZURE.IMPORTANT] Задания импорта и экспорта для классического хранилища можно создавать и контролировать с помощью классического портала или интерфейсов [REST API службы импорта и экспорта](http://go.microsoft.com/fwlink/?LinkID=329099). В настоящее время учетные записи хранения Resource Manager не поддерживаются.

## Когда следует использовать службу импорта и экспорта Azure?

Службу импорта и экспорта Azure можно использовать, если отправка или скачивание данных по сети занимают слишком много времени, а увеличение пропускной способности сети нерентабельно.

Эту службу можно использовать в следующих сценариях:

- Перенос данных в облако: быстрое и эффективное перемещение больших объемов данных в Azure.
- Распространение содержимого: быстрая отправка данных на веб-сайты клиентов.
- Резервное копирование: создание резервных копий локальных данных для хранения в хранилище BLOB-объектов Azure.
- Восстановление данных: восстановление большого объема данных в хранилище BLOB-объектов и его перенос в локальное расположение.

## Предварительные требования

В этом разделе перечислены предварительные требования, которые должны выполняться для работы с этой службой. Изучите их перед отправкой дисков.

### Учетная запись хранения

Для использования службы импорта и экспорта необходимо иметь подписку Azure, а также одну или несколько **классических** учетных записей хранения. Каждое задание может использоваться для обмена данными только с одной классической учетной записью хранения. Другими словами, отдельное задание импорта и экспорта не может распространяться на несколько учетных записей хранения. Сведения о создании новой учетной записи хранения см. в разделе [Создание учетной записи хранения](storage-create-storage-account.md#create-a-storage-account).

### Типы BLOB-объектов

Службу импорта и экспорта Azure можно использовать для копирования данных в **блочные** или **страничные** BLOB-объекты. Кроме того, с ее помощью можно экспортировать из службы хранилища Azure только **блочные**, **страничные** или **добавочные** BLOB-объекты.

### Задание

Чтобы начать процесс импорта или экспорта из хранилища BLOB-объектов, необходимо сначала создать задание. Заданием может являться задание импорта или задание экспорта:

- Создайте задание импорта, если необходимо передать локальные данные в большие двоичные объекты, которые содержатся в вашей учетной записи хранения Azure.
- Создайте задание экспорта, если необходимо передать данные, которые в настоящее время хранятся в BLOB-объектах вашей учетной записи хранения, на отправленные вам жесткие диски.

При создании задания вы уведомляете службу импорта и экспорта о том, что отправите один или несколько жестких дисков в центр обработки данных Azure.

- При создании задания импорта необходимо отправить жесткие диски, содержащие файлы данных.
- При создании задания экспорта необходимо отправить пустые жесткие диски.
- Отправлять можно до десяти жестких дисков на задание.

Задание импорта или экспорта можно создать с помощью [классического портала](https://manage.windowsazure.com/) или [REST API импорта и экспорта службы хранилища Azure](http://go.microsoft.com/fwlink/?LinkID=329099).

### Средство клиента

Создание задания **импорта** начинается с подготовки диска, который будет отправлен для импорта данных. Чтобы подготовить диск, необходимо подключить его к локальному серверу и запустить клиентское средство импорта и экспорта Azure на локальном сервере. Это клиентское средство упрощает копирование данных на диск, шифрование данных на диске с использованием BitLocker и создание файлов журналов для дисков.

В файлах журналов хранятся сведения о задании и диске, такие как серийный номер диска и имя учетной записи хранения. Этот файл журнала не хранится на диске. Он используется при создании задания импорта. Пошаговые инструкции по созданию заданий приводятся ниже в этой статье.

Клиентское средство совместимо только с 64-разрядной операционной системой Windows. Поддерживаемые версии перечислены в разделе [Операционная система](#operating-system).

Последнюю версию клиентского средства импорта и экспорта Azure можно скачать [здесь](http://go.microsoft.com/fwlink/?LinkID=301900&clcid=0x409). Дополнительные сведения о средстве импорта и экспорта Azure см. в [справочнике по средству импорта и экспорта Azure](http://go.microsoft.com/fwlink/?LinkId=329032).

### Жесткие диски

Для использования со службой импорта и экспорта поддерживаются только внутренние жесткие диски форм-фактора 3,5 дюйма, SATA II или III. Можно использовать жесткие диски емкостью до 10 ТБ. В заданиях импорта на диске будет обрабатываться только первый том данных. Том с данными должен быть отформатирован в NTFS. Жесткий диск для копирования данных можно подключить напрямую с помощью разъема SATA или через внешний USB-адаптер SATA II/III. Рекомендуем использовать один из следующих внешних USB-адаптеров SATA II/III:

- Anker 68UPSATAA-02BU
- Anker 68UPSHHDS-BU
- Startech SATADOCK22UE
- Sharkoon QuickPort XT HC

Если вы используете конвертер, не указанный в списке выше, попробуйте проверить работу своего конвертера при работе со средством импорта и экспорта Azure для подготовки диска. Если все нормально, то приобретать поддерживаемый конвертер не нужно.

> [AZURE.IMPORTANT] Эта служба не поддерживает внешние жесткие диски, имеющие встроенный USB-адаптер. Кроме того, нельзя использовать диски во внешнем корпусе. Не отправляйте внешние жесткие диски.

### Шифрование

Данные на диске должны быть зашифрованы с помощью технологии шифрования дисков BitLocker. Это защитит данные во время пересылки.

Для заданий импорта данные можно шифровать двумя способами. Первый способ — при запуске клиентского средства в процессе подготовки диска использовать параметр /encrypt. Второй способ — включить шифрование BitLocker на диске вручную и указать ключ шифрования в командной строке клиентского средства при подготовке диска.

В случае экспорта после копирования данных на диск и прежде чем передать его вам, служба выполняет шифрование BitLocker. Ключ шифрования предоставляется пользователю через классический портал.

### Операционная система

Для подготовки жесткого диска с помощью средства импорта и экспорта Azure перед отправкой диска в Azure можно использовать следующие 64-разрядные операционные системы:

Windows 7 Корпоративная, Windows 7 Максимальная, Windows 8 Профессиональная, Windows 8 Корпоративная, Windows 8.1 Профессиональная, Windows 8.1 Корпоративная, Windows 10<sup>1</sup>, Windows Server 2008 R2, Windows Server 2012, Windows Server 2012 R2. Все эти операционные системы поддерживают шифрование диска BitLocker.

> [AZURE.IMPORTANT] <sup>1</sup> При использовании компьютера Windows 10 для подготовки жесткого диска скачайте последнюю версию средства импорта и экспорта Azure.

### Расположения

Служба импорта и экспорта Azure поддерживает копирование данных в любые учетные записи хранения общедоступной службы Azure и из них. Жесткие диски можно отправлять в одно из указанных ниже расположений. Если ваша учетная запись хранения находится в общедоступном расположении Azure, которое здесь не указано, при создании задания на классическом портале или с помощью REST API службы импорта и экспорта вам будет предложено альтернативное расположение.

Диски можно отправлять в следующие расположения:

- Восток США

- Запад США

- Восток США 2

- Центральный регион США

- Северо-центральный регион США

- Южно-центральный регион США

- Северная Европа

- Западная Европа

- Восточная Азия

- Юго-Восточная Азия

- Восточная часть Австралии

- Юго-Восточная часть Австралии

- Западная часть Японии

- Восточная часть Японии

- Центральная Индия


### Отправка

**Доставка дисков в центр обработки данных:**

При создании задания импорта или экспорта вам будет предоставлен почтовый адрес одного из поддерживаемых расположений для отправки дисков. Адрес доставки будет зависеть от расположения вашей учетной записи хранения, но может от него отличаться.

Диски можно отправлять по почте, а также через такие службы доставки, как FedEx, DHL, UPS или почтовое ведомство США.

**Доставка дисков из центра обработки данных**

Создавая задание импорта или экспорта, вы должны указать обратный адрес, который будет использоваться корпорацией Майкрософт для возврата дисков после выполнения этого задания. Чтобы избежать задержек, укажите действительный обратный адрес.

Кроме того, для возврата корпорацией Майкрософт дисков необходимо указать действительный номер учетной записи транспортного агента FedEx или DHL. Номер учетной записи FedEx необходим для возврата жестких дисков из расположений в США и Европе, а номер учетной записи DHL — из расположений в Азии и Австралии. Вы можете создать учетную запись транспортного агента для [FedEx](http://www.fedex.com/us/oadr/) (США и Европа) или [DHL](http://www.dhl.com/) (Азия и Австралия), если ее у вас еще нет. Если у вас уже есть учетная запись, убедитесь в том, что она действительна.

При отправке пакетов должны соблюдаться условия раздела [Условия обслуживания Мicrosoft Azure](https://azure.microsoft.com/support/legal/services-terms/).

> [AZURE.IMPORTANT] Обратите внимание, что отправляемые физические носители могут пересекать международные границы. Вы несете ответственность за то, что ваши физические носители и данные импортируются и (или0 экспортируются в соответствии с действующим законодательством. Перед отправкой физических носителей проконсультируйтесь и удостоверьтесь, что эти носители и данные могут быть отправлены в определенный центр обработки данных на законных основаниях. Это поможет Майкрософт своевременно получить посылку. Например, любой пакет, который будет пересекать международные границы, должен сопровождаться торговым счетом-фактурой (за пересечения границ в пределах ЕС). Можно распечатать заполненную копию торгового счета-фактуры с веб-сайта перевозчика. Примеры торгового счета-фактуры: [торговый счет-фактура DHL](http://invoice-template.com/wp-content/uploads/dhl-commercial-invoice-template.pdf) и [торговый счет-фактура FedEx](http://images.fedex.com/downloads/shared/shipdocuments/blankforms/commercialinvoice.pdf). Убедитесь в том, что корпорация Майкрософт не указана в качестве экспортера.

## Как работает служба импорта и экспорта Azure?

Данные можно передавать между локальным сайтом и хранилищем BLOB-объектов Azure с помощью службы импорта и экспорта Azure, создавая задания и отправляя жесткие диски в центр обработки данных Azure. Каждый отправляемый жесткий диск сопоставляется с отдельным заданием, а каждое задание — с отдельной учетной записью хранения. Внимательно изучите раздел [предварительных требований](#pre-requisites), чтобы узнать особенности этой службы, такие как поддерживаемые типы больших двоичных объектов, типы дисков, расположения и отправка.

В этом разделе подробно описаны действия, связанные с заданиями импорта и экспорта. Ниже, в разделе [Быстрый запуск](#quick-start), представлены пошаговые инструкции по созданию заданий импорта и экспорта.

### Задание импорта

На высоком уровне задание импорта включает следующие действия:

- Определите данные для импорта, а также количество дисков, которое понадобится.
- Определите целевые BLOB-объекты для ваших данных в хранилище BLOB-объектов.
- Используйте средство импорта и экспорта Azure для копирования данных на один или несколько жестких дисков и их шифрования по технологии BitLocker.
- Создайте задание импорта в соответствующей классической учетной записи хранения на классическом портале или с помощью REST API службы импорта и экспорта. Если используется классический портал, отправьте файлы журналов диска.
- Укажите обратный адрес и номер учетной записи транспортного агента для возврата дисков.
- Отправьте жесткие диски по адресу, указанному при создании задания.
- Обновите номер отслеживания доставки в сведениях о задании импорта и отправьте задание импорта.
- Диски принимаются и обрабатываются центром обработки данных Azure.
- Диски возвращаются с использованием учетной записи транспортного агента по обратному адресу, указанному в задании импорта.

	![Рисунок 1. Процесс выполнения задания импорта](./media/storage-import-export-service/importjob.png)


### Задание экспорта

На высоком уровне задание экспорта включает следующие действия:

- Определите данные для экспорта, а также количество дисков, которое понадобится.
- Укажите пути к BLOB-объектам и контейнерам исходных данных в хранилище BLOB-объектов.
- Создайте задание экспорта в исходной учетной записи хранения на классическом портале или с помощью REST API службы импорта и экспорта.
- Укажите пути к BLOB-объектам и контейнерам исходных данных в задании экспорта.
- Укажите обратный адрес и номер учетной записи транспортного агента для возврата дисков.
- Отправьте жесткие диски по адресу, указанному при создании задания.
- Обновите номер отслеживания доставки в сведениях о задании экспорта и отправьте задание экспорта.
- Диски принимаются и обрабатываются центром обработки данных Azure.
- Диски шифруются по технологии BitLocker. Ключи доступны на классическом портале.
- Диски возвращаются с использованием учетной записи транспортного агента по обратному адресу, указанному в задании импорта.

	![Рисунок 2. Процесс выполнения задания экспорта](./media/storage-import-export-service/exportjob.png)

### Просмотр состояния задания

Вы можете отслеживать состояние задания импорта или экспорта на классическом портале Azure. Перейдите к своей учетной записи хранения на классическом портале Azure и щелкните вкладку **Импорт и экспорт**. На странице появится список заданий. Можно отфильтровать список по состоянию задания, имени задания, типу задания или номеру отслеживания.

В зависимости от места обработки диска вы увидите одно из следующих состояний задания:

| Состояние задания | Описание |
|:-------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Создание | Ваше задание было создано, однако вы пока не предоставили данные об отправке. |
| Отправка | Ваше задание было создано, и вы предоставили данные об отправке. **Примечание**. Для диска, доставленного в центр обработки данных Azure, в течение некоторого времени может отображаться состояние "Доставка". Как только служба начнет копировать данные, состояние изменится на "Передача данных". Чтобы увидеть более точное состояние диска, можно использовать REST API службы импорта и экспорта. |
| Передача | Данные передаются с жесткого диска (для задания импорта) или на жесткий диск (для задания экспорта). |
| Упаковка | Передача данных завершена, жесткий диск подготавливается для отправки на ваш адрес. |
| Завершено | Жесткий диск был отправлен на ваш адрес. |

### Время обработки задания

Время обработки задания импорта или экспорта зависит от различных факторов, таких как время отправки, тип задания, тип и размер копируемых данных и размер дисков. Служба импорта и экспорта не имеет соглашения об уровне обслуживания. Более точно отслеживать ход выполнения задания можно с помощью API REST. В операции "Список заданий" есть параметр процентного выполнения, отражающий ход копирования. Если вам нужно узнать примерное время выполнения критического задания импорта или экспорта, свяжитесь с нами.

### Цены

**Стоимости обработки дисков**

За обработку каждого диска в рамках задания импорта или экспорта взимается плата. Дополнительные сведения см. на странице [цен на импорт и экспорт Azure](https://azure.microsoft.com/pricing/details/storage-import-export/).

**Стоимость отправки**

При отправке дисков в Azure вы оплачиваете транспортные расходы перевозчика. Когда Майкрософт возвращает вам диск, стоимость обратной пересылки списывается с вашей учетной записи транспортного агента, указанной при создании задания.

**Плата за транзакции**

При импорте данных в хранилище BLOB-объектов плата за транзакции не взимается. При экспорте данных из хранилища BLOB-объектов взимается стандартная плата за исходящие данные. Дополнительные сведения о стоимости транзакций см. на странице [Сведения о ценах — передача данных](https://azure.microsoft.com/pricing/details/data-transfers/).

## Быстрый запуск

В этом разделе представлены пошаговые инструкции по созданию задания импорта и экспорта. Прежде чем переходить к следующим шагам, убедитесь, что соблюдены все [предварительные требования](#pre-requisites).

## Как создать задание импорта?

Задание импорта создается для копирования данных в учетную запись хранения Azure из жестких дисков путем отправки одного или нескольких дисков с данными в указанный центр обработки данных. Задание импорта передает сведения о жестких дисках, данных для копирования, целевой учетной записи хранения и адресе доставки в службу импорта и экспорта Azure. Задание импорта создается в три этапа. Во-первых, необходимо подготовить диск с помощью клиентского средства импорта и экспорта Azure. Во-вторых, следует создать задание импорта на классическом портале Azure. В-третьих, нужно отправить диск по адресу, указанному при создании задания, и обновить информацию о доставке в сведениях о задании.

> [AZURE.IMPORTANT] Отправлять можно только одно задание на учетную запись хранения. Каждый пересылаемый диск должен импортироваться в одну учетную запись хранения. Допустим, вы хотите импортировать данные в две учетные записи хранения. Для каждой учетной записи хранения необходимо использовать отдельный жесткий диск и создавать отдельное задание.

### Подготовка дисков

В первую очередь при импорте данных с помощью клиентского средства импорта и экспорта Azure необходимо подготовить диски, используя это средство. Для подготовки дисков сделайте следующее:

1.	Укажите данные для импорта. Это могут быть папки или отдельные файлы на локальном сервере или в общей сетевой папке.

2.	Определите необходимое количество дисков в зависимости от общего объема данных. Приобретите необходимое количество 3,5-дюймовых жестких дисков SATA II или III.

3.	Определите целевую учетную запись хранения, контейнер, виртуальные папки и большие двоичные объекты.

4.	Определите каталоги и (или) автономные файлы, которые будут скопированы на каждый жесткий диск.

5.	Используйте [средство импорта и экспорта Azure](http://go.microsoft.com/fwlink/?LinkID=301900&clcid=0x409) для копирования данных на один или несколько жестких дисков.

	- Средство импорта и экспорта Azure создает сеансы копирования данных из источника на жесткие диски. В отдельном сеансе копирования средство может скопировать отдельную папку вместе с входящими в него подпапками или отдельный файл.

	- Если исходные данные охватывают несколько каталогов, может потребоваться несколько сеансов копирования.

	- Для каждого жесткого диска потребуется как минимум один сеанс копирования.

6.	Чтобы включить шифрование Bitlocker на жестком диске, можно указать параметр /encrypt. Кроме того, можно вручную включать шифрование Bitlocker на жестком диске и указать ключ во время выполнения средства.

7.	Средство импорта и экспорта Azure создает файл журнала диска для каждого диска при его подготовке. Файл журнала диска хранится на локальном компьютере, а не на самом диске. Файл журнала передается при создании задания импорта. Файл журнала диска включает идентификатор диска и ключ BitLocker, а также другие сведения о диске. **Важно**! Для каждого подготовленного диска формируется файл журнала. Создавая задание импорта на классическом портале, необходимо отправить все файлы журналов для дисков, которые входят в это задание. Диски без файлов журналов обрабатываться не будут.

8.	Не изменяйте данные на жестких дисках или в файлах журналов после завершения подготовки этих дисков.

Ниже представлены команды и примеры подготовки жесткого диска с помощью средства импорта и экспорта Azure.

Команда PrepImport в службе импорта и экспорта Azure для первого сеанса копирования каталога:

	WAImportExport PrepImport /sk:<StorageAccountKey> /csas:<ContainerSas> /t: <TargetDriveLetter> [/format] [/silentmode] [/encrypt] [/bk:<BitLockerKey>] [/logdir:<LogDirectory>] /j:<JournalFile> /id:<SessionId> /srcdir:<SourceDirectory> /dstdir:<DestinationBlobVirtualDirectory> [/Disposition:<Disposition>] [/BlobType:<BlockBlob|PageBlob>] [/PropertyFile:<PropertyFile>] [/MetadataFile:<MetadataFile>]

**Пример**

В приведенном ниже примере мы копируем все файлы и подпапки из каталога H:\\Video на жесткий диск, установленный в каталог X. Данные будут импортированы в целевую учетную запись хранения, указанную с помощью ключа учетной записи хранения, и в контейнер хранилища video. Если контейнер хранилища не существует, он будет создан. Кроме того, эта команда форматирует и шифрует целевой жесткий диск.

	WAImportExport.exe PrepImport /j:FirstDrive.jrn /id:Video1 /logdir:c:\logs /sk:storageaccountkey /t:x /format /encrypt /srcdir:H:\Video1 /dstdir:video/ /MetadataFile:c:\WAImportExport\SampleMetadata.txt

Команда PrepImport в службе импорта и экспорта Azure для последующих сеансов копирования каталогов:

	WAImportExport PrepImport /j:<JournalFile> /id:<SessionId> /srcdir:<SourceDirectory> /dstdir:<DestinationBlobVirtualDirectory> [/Disposition:<Disposition>] [/BlobType:<BlockBlob|PageBlob>] [/PropertyFile:<PropertyFile>] [/MetadataFile:<MetadataFile>]

Для последующих сеансов копирования на тот же жесткий диск укажите имя того же файла журнала и новый идентификатор сеанса. Указывать ключ учетной записи хранения и целевой диск, а также формировать и шифровать диск не требуется. В этом примере мы копируем папку H:\\Photo вместе со всеми подпапками на тот же целевой диск в контейнер хранилища photo.

	WAImportExport.exe PrepImport /j:FirstDrive.jrn /id:Photo /srcdir:H:\Photo /dstdir:photo/ /MetadataFile:c:\WAImportExport\SampleMetadata.txt

Команда PrepImport в службе импорта и экспорта Azure для первого сеанса копирования файла:

	WAImportExport PrepImport /sk:<StorageAccountKey> /csas:<ContainerSas> /t: <TargetDriveLetter> [/format] [/silentmode] [/encrypt] [/bk:<BitLockerKey>] [/logdir:<LogDirectory>] /j:<JournalFile> /id:<SessionId> /srcfile:<SourceFile> /dstblob:<DestinationBlobPath> [/Disposition:<Disposition>] [/BlobType:<BlockBlob|PageBlob>] [/PropertyFile:<PropertyFile>] [/MetadataFile:<MetadataFile>]

Команда PrepImport в службе импорта и экспорта Azure для последующих сеансов копирования файла:

	WAImportExport PrepImport /j:<JournalFile> /id:<SessionId> /srcfile:<SourceFile> /dstblob:<DestinationBlobPath> [/Disposition:<Disposition>] [/BlobType:<BlockBlob|PageBlob>] [/PropertyFile:<PropertyFile>] [/MetadataFile:<MetadataFile>]

**Помните**! По умолчанию данные импортируются как блочные BLOB-объекты. Для импорта данных в виде страничных BLOB-объектов используйте параметр /BlobType. Например, файлы виртуальных жестких дисков, которые будут устанавливаться на виртуальной машине Azure, необходимо импортировать как страничные BLOB-объекты. Если вы не знаете, какой большой двоичный объект использовать, укажите параметр /blobType:auto, чтобы мы могли подобрать для вас тип большого двоичного объекта. В этом случае все файлы VHD и VHDX импортируются как страничные BLOB-объекты, а остальные — как блочные.

Дополнительные сведения об использовании клиентского средства импорта и экспорта Azure см. в статье [Подготовка жестких дисков для задания импорта](https://msdn.microsoft.com/library/dn529089.aspx).

Пошаговые инструкции см. в статье [Пример рабочего процесса для подготовки жестких дисков для задания импорта](https://msdn.microsoft.com/library/dn529097.aspx).

### Создание задания импорта

1.	После подготовки диска перейдите к своей учетной записи хранения на [классическом портале](https://manage.windowsazure.com) Azure и просмотрите панель мониторинга. В разделе **Сводка**, щелкните **Создать задание импорта** Просмотрите инструкции и установите флажок, чтобы указать, что вы подготовили диск и у вас есть доступный файл журнала.

2.	На шаге 1 предоставьте контактные сведения лица, ответственного за это задание импорта, и действительный обратный адрес. Если необходимо сохранить подробные данные журнала задания импорта, установите флажок **Сохранить подробный журнал в контейнере blob-объектов 'waimportexport'**.

3.	На шаге 2 передайте файлы журналов диска, полученные на этапе подготовки диска. Необходимо передать один файл для каждого подготовленного диска.

	![Создание задание импорта – шаг 3](./media/storage-import-export-service/import-job-03.png)

4.	На шаге 3 введите описательное имя для задания импорта. Обратите внимание,что вводимое имя может содержать только строчные буквы, цифры, дефисы и подчеркивания, кроме того, оно должно начинаться с буквы и не содержать пробелов. Выбранное имя будет использоваться для отслеживания выполняемых заданий, а также после их завершения.

	Далее выберите регион своего центра обработки данных из списка. Регион центра обработки данных будет означать центр обработки данных, куда следует направить пакет. Дополнительные сведения см. в приведенном ниже разделе "Часто задаваемые вопросы".

5. 	На шаге 4 выберите транспортный агент из списка и введите его номер учетной записи. Майкрософт будет использовать эту учетную запись для отправки дисков обратно после завершения задания импорта.

	Если у вас есть номер для отслеживания отправки, выберите поставщика почтовых услуг из списка и введите свой номер.

	Если у вас пока нет номера отслеживания, выберите **Я предоставлю данные об отправке этого задания импорта после отправки посылки**, затем завершите процесс импорта.

6. Чтобы ввести номер для отслеживания после отправки пакета, вернитесь на страницу **Импорт и экспорт** своей учетной записи хранения на классическом портале Azure, выберите задание из списка и щелкните **Данные об отправке**. Просмотрите мастер и введите номер для отслеживания на шаге 2.

	Если номер отслеживания не обновляется в течение 2 недель с момента создания задания, срок действия задания истекает.

	Если задание находится в состоянии создания, отправки или передачи, можно также обновить номер учетной записи транспортного агента на шаге 2 мастера. После того, как задание переходит в состояние упаковки, обновить номер учетной записи транспортного агента для него нельзя.

7. Ход выполнения задания можно отслеживать на панели мониторинга портала. Описание каждого состояния см. в разделе [Просмотр состояния задания](#viewing-your-job-status).

## Как создать задание экспорта?

Создайте задание экспорта для уведомления службы импорта и экспорта о том, что вы отправите один или несколько пустых жестких дисков в центр обработки данных, чтобы данные были экспортированы из вашей учетной записи хранения на диски с последующей отправкой на ваш адрес.

### Подготовка дисков

Для подготовки дисков к заданиям экспорта рекомендуется выполнить следующие предварительные проверки:

1. Проверьте необходимое количество дисков с помощью команды PreviewExport средства импорта и экспорта Azure. Дополнительные сведения см. в разделе [Предварительный просмотр использования дисков для задания экспорта](https://msdn.microsoft.com/library/azure/dn722414.aspx). Это позволяет просмотреть использование диска для выбранных больших двоичных объектов в зависимости от объема дисков, которые вы собираетесь использовать.

2. Убедитесь, что вы можете считывать и записывать на жесткий диск, который будет предоставлен для задания экспорта.

### Создание задания экспорта

1. 	Чтобы создать задание экспорта, перейдите к учетной записи хранения на [классическом портале](https://manage.windowsazure.com) Azure и просмотрите панель мониторинга. В разделе **Сводка** щелкните **Создать задание экспорта** и выполните указания мастера.

2. 	На шаге 2 предоставьте контактные сведения лица, ответственного за это задание экспорта. Если необходимо сохранить подробные данные журнала задания экспорта, установите флажок **Сохранить подробный журнал в контейнере blob-объектов 'waimportexport'**.

3.	На шаге 3 укажите, какие данные BLOB-объектов необходимо экспортировать из своей учетной записи хранения на пустой диск или диски. Можно экспортировать все данные blob-объектов в учетной записи хранения или выбрать blob-объекты, или их наборы.

	Чтобы указать blob-объект для экспорта, используйте селектор **Равно** и укажите относительный путь к blob-объекту, начиная с имени контейнера. Используйте *$root* для указания корневого контейнера.

	Чтобы указать все blob-объекты, начинающиеся с префикса, используйте селектор **Начинается с** и укажите префикс, которому предшествует косая черта "/". Префикс может являться префиксом имени контейнера, полным именем контейнера или полным именем контейнера с префиксом имени blob-объекта.

	В следующей таблице приведены примеры допустимых путей к большим двоичным объектам.

	Выбор|Путь к BLOB-объекту|Описание
	---|---|---
	Начинается с|/|Экспорт всех blob-объектов в учетной записи хранения
	Начинается с|/$root/|Экспорт всех blob-объектов в корневом контейнере
	Начинается с|/book|Экспортирует все blob-объекты в любом контейнере, который начинается с префикса**book**
	Начинается с|/music/|Экспортирует все blob-объекты в контейнере **music**
	Начинается с|/music/love|Экспортирует все blob-объекты в контейнере **music**, которые начинаются с префикса **love**
	Равно|$root/logo.bmp|Экспортирует blob-объект **logo.bmp** в корневом контейнере
	Равно|videos/story.mp4|Экспортирует blob-объект **story.mp4** в контейнере **videos**

	Чтобы избежать ошибок во время обработки, необходимо указать пути к большим двоичным объектам в допустимом формате, как показано на приведенном ниже снимке экрана.

	![Создание задание экспорта – шаг 3](./media/storage-import-export-service/export-job-03.png)


4.	На шаге 4 введите описательное имя для задания экспорта. Обратите внимание,что вводимое имя может содержать только строчные буквы, цифры, дефисы и подчеркивания, кроме того, оно должно начинаться с буквы и не содержать пробелов.

	Регион центра обработки данных будет означать центр обработки данных, куда следует направить посылку. Дополнительные сведения см. в приведенном ниже разделе "Часто задаваемые вопросы".

5. 	На шаге 5 выберите транспортного агента из списка и введите его номер учетной записи. Майкрософт будет использовать эту учетную запись для отправки дисков вам обратно после завершения задания экспорта.

	Если у вас есть номер для отслеживания отправки, выберите поставщика почтовых услуг из списка и введите свой номер.

	Если у вас пока нет номера отслеживания, выберите **Я предоставлю данные об отправке этого задания экспорта после отправки пакета**, затем завершите процесс экспорта.

6. Чтобы ввести номер для отслеживания после отправки пакета, вернитесь на страницу **Импорт и экспорт** своей учетной записи хранения на классическом портале Azure, выберите задание из списка и щелкните **Данные об отправке**. Просмотрите мастер и введите номер для отслеживания на шаге 2.

	Если номер отслеживания не обновляется в течение 2 недель с момента создания задания, срок действия задания истекает.

	Если задание находится в состоянии создания, отправки или передачи, можно также обновить номер учетной записи транспортного агента на шаге 2 мастера. После того, как задание переходит в состояние упаковки, обновить номер учетной записи транспортного агента для него нельзя.

	> [AZURE.NOTE] Если BLOB-объекты для экспорта используются во время копирования на жесткий диск, службы импорта и экспорта Azure сделают снимок большого двоичного объекта и скопируют моментальный снимок.

7.	Ход выполнения задания можно отслеживать на панели мониторинга классического портала. См., что означает каждое состояние, в разделе "Просмотр состояния задания".

8.	После получения дисков с экспортированными данными вы можете просмотреть и скопировать ключи BitLocker, сгенерированные службой для вашего диска. Перейдите в учетную запись хранения на классическом портале Azure и щелкните вкладку "Импорт и экспорт". Выберите задание экспорта из списка и нажмите кнопку Просмотреть ключи. Ключи BitLocker отображаются, как показано ниже:

	![Просмотр ключей BitLocker для задания экспорта](.\media\storage-import-export-service\export-job-bitlocker-keys.png)

Просмотрите раздел часто задаваемых вопросов, в котором рассматриваются наиболее распространенные вопросы, возникающие у клиентов при работе с этой службой.

## Часто задаваемые вопросы ##


**Сколько времени занимает копирование после того, как мой диск попадет в центр обработки данных?**

Время копирования зависит от различных факторов, таких как тип задания, тип и размер копируемых данных, размер дисков и текущий объем рабочей нагрузки. Он может составлять от нескольких дней до пары недель в зависимости от этих факторов. В связи с этим общую оценку дать сложно. Служба пытается оптимизировать задание, по возможности копируя несколько дисков параллельно. Чтобы узнать примерное время выполнения критического задания импорта или экспорта, свяжитесь с нами.

**Когда следует использовать службу импорта и экспорта Azure?** Рассмотреть возможность использования службы импорта и экспорта Azure следует, если согласно примерной оценке передача или скачивание данных по сети займет больше 7 дней. Рассчитать, сколько времени потребуется, можно, воспользовавшись онлайн-калькулятором или [скачав](https://github.com/Azure-Samples/storage-dotnet-import-export-job-management/archive/master.zip) калькулятор, представленный в примере REST API службы импорта и экспорта Azure в репозитории примеров Azure, в разделе [калькулятора скорости передачи данных](https://github.com/Azure-Samples/storage-dotnet-import-export-job-management/blob/master/DataTransferSpeedCalculator.html). Калькулятор выдает не точное значение, а только приблизительную оценку.

**Можно ли использовать службу импорта и экспорта Azure с учетной записью хранения Resource Manager?**

Нет, напрямую скопировать данные в учетную запись хранения Resource Manager или из нее с помощью службы импорта и экспорта Azure нельзя. Служба поддерживает только классические учетные записи хранения. Поддержка учетных записей хранения Resource Manager будет реализована в ближайшее время. В качестве альтернативы можно импортировать данные в классическую учетную запись хранения и перенести ее в учетную запись хранения Resource Manager с помощью [AzCopy](storage-use-azcopy.md) или CopyBlob.

**Можно ли скопировать файлы Azure с помощью службы импорта и экспорта Azure?**

Нет. Служба импорта и экспорта Azure поддерживает только блочные и страничные BLOB-объекты. Все остальные типы хранилищ, включая файлы, таблицы и очереди Azure, не поддерживаются.

**Доступна ли служба импорта и экспорта Azure для подписок CSP?**

Нет. Служба импорта и экспорта Azure не поддерживает подписки CSP. Их поддержка будет добавлена в будущем.

**Можно ли пропустить этап подготовки диска для задания импорта или подготовить диск без копирования?**

Каждый диск, который вы собираетесь отправить для импорта данных, необходимо подготовить, используя средство импорта и экспорта Azure. Данные копируются на диск с помощью клиентского средства.

**Нужно ли провести какую-либо подготовку диска при создании задания экспорта?**

Нет, но рекомендуется использовать некоторые предварительные проверки. Проверьте необходимое количество дисков с помощью команды PreviewExport средства импорта и экспорта Azure. Дополнительные сведения см. в разделе [Предварительный просмотр использования дисков для задания экспорта](https://msdn.microsoft.com/library/azure/dn722414.aspx). Это позволяет просмотреть использование диска для выбранных больших двоичных объектов в зависимости от объема дисков, которые вы собираетесь использовать. Убедитесь также, что вы можете считывать и записывать на жесткий диск, который будет предоставлен для задания экспорта.

**Что произойдет, если я случайно отправлю диски, которые не соответствуют требованиям поддержки?**

Центр обработки данных Azure вернет диски, которые не соответствуют требованиям поддержки. Если только некоторые диски в посылке соответствуют требованиям поддержки, эти диски будут обработаны, а диски, не соответствующие требованиям, будут возвращены вам.

**Можно ли отменить свое задание?**

Можно отменить задание, если его состояние указано как "Создание" или "Отправка".

**Как долго можно просматривать состояние выполненных заданий на классическом портале Azure?**

Состояние выполненных заданий можно просматривать в течение 90 дней. Через 90 дней завершенные задания будут удалены.

**Что мне нужно делать, чтобы импортировать или экспортировать более 10 дисков?**

В предварительной версии службы импорта и экспорта в рамках одного задания импорта или экспорта может обрабатываться только 10 дисков. Если необходимо поставить более 10 дисков, можно создать несколько заданий. Диски, связанные с одним и тем же заданием, необходимо отправлять одним пакетом.

**Можно ли использовать USB-адаптер SATA, не включенный в список рекомендованных адаптеров?**

Если вы используете конвертер, не указанный в списке выше, попробуйте проверить работу своего конвертера при работе со средством импорта и экспорта Azure для подготовки диска. Если все нормально, то приобретать поддерживаемый конвертер не нужно.

**Форматируете ли вы диски перед их возвращением?**

Нет. Все диски шифруются по технологии BitLocker.

**Можно ли приобрести диски для заданий импорта и экспорта у корпорации Майкрософт?**

Нет. Необходимо предоставлять собственные диски для заданий импорта и экспорта.

**Как будут выглядеть мои данные в учетной записи хранения после завершения задания импорта? Сохранится ли иерархия моих каталогов? **

При подготовке жесткого диска для задания импорта место назначения определяется параметром /dstdir:. Это целевой контейнер в учетной записи хранения, в который копируются данные с жесткого диска. В целевом контейнере для папок с жесткого диска создаются виртуальные каталоги, а для файлов — большие двоичные объекты.

**Если на диске есть файлы, уже существующие в учетной записи хранения, будут ли они перезаписаны службой?**

При подготовке диска можно указать, нужно ли перезаписать целевые файлы или игнорировать совпадения, используя параметр /Disposition:<rename|no-overwrite|overwrite>. По умолчанию служба не перезаписывает большие двоичные объекты, а переименовывает новые файлы.

**Совместимо ли средство импорта и экспорта Azure с 32-разрядной операционной системой?** Нет. Клиентское средство совместимо только с 64-разрядной операционной системой Windows. Полный список поддерживаемых версий ОС см. в разделе [Предварительные требования](#pre-requisites).

**Нужно ли отправлять вместе с жесткими дисками что-то еще?**

Отправляйте только жесткие диски. Не посылайте ничего другого, например, кабели питания или USB-кабели.

**Обязательно ли отправлять диски через FedEx или DHL?**

Вы можете отправлять диски в центр обработки данных через любую транспортную компанию, включая FedEx, DHL и UPS, или почтовое ведомство США. При этом для возврата дисков из центра обработки данных необходимо указать номер учетной записи FedEx в США и Европе или DHL в Азии и Австралии.

**Существуют ли ограничения на международную пересылку дисков?**

Обратите внимание, что отправляемые физические носители могут пересекать международные границы. Вы несете ответственность за то, что ваши физические носители и данные импортируются и (или0 экспортируются в соответствии с действующим законодательством. Перед отправкой физических носителей проконсультируйтесь и удостоверьтесь, что они эти носители и данные могут быть отправлены в определенный центр обработки данных на законных основаниях. Это поможет Майкрософт своевременно получить посылку.

**При создании задания был указан адрес доставки, который отличается от расположения учетной записи хранения. Что делать?**

Некоторые расположения учетных записей хранения сопоставляются с альтернативными расположениями доставки. Ранее доступные места доставки можно было также временно сопоставить с другими расположениями. Перед отправкой дисков обязательно проверяйте адрес доставки, указанный при создании задания.

**Почему мое задание на классическом портале находится в состоянии "Доставка", но при этом на веб-сайте транспортного агента моя посылка отображается как доставленная?**

Изменение состояния с "Доставка" на "Передача" на классическом портале происходит в момент начала обработки диска. Если диск поступил в наше распоряжение, но его обработка еще не началась, задание будет находиться в состоянии "Доставка".

**При отправке диска транспортный агент запрашивает имя и номер телефона контактного лица в центре обработки данных. Что нужно указать? **

Номер телефона сообщается вам при создании задания. Если вам нужно имя контактного лица, свяжитесь с нами по адресу waimportexport@microsoft.com, и мы сообщим вам эти данные.

**Можно ли использовать службу импорта и экспорта Azure для копирования почтовых ящиков PST и данных SharePoint в Office 365?**

Дополнительные сведения см. в статье [Импорт PST-файлов или данных SharePoint в Office 365](https://technet.microsoft.com/library/ms.o365.cc.ingestionhelp.aspx).

**Можно ли использовать службу импорта и экспорта Azure для копирования резервных копий в службу архивации Azure в автономном режиме?**

Дополнительные сведения см. в статье [Автономное резервное копирование в службе архивации Azure](../backup/backup-azure-backup-import-export.md).

## См. также:

- [Настройка клиентского средства импорта и экспорта Azure](https://msdn.microsoft.com/library/dn529112.aspx)

- [Приступая к работе со служебной программой командной строки AzCopy](storage-use-azcopy.md)

- [Пример REST API службы импорта и экспорта Azure](https://azure.microsoft.com/documentation/samples/storage-dotnet-import-export-job-management/)

<!---HONumber=AcomDC_0921_2016-->