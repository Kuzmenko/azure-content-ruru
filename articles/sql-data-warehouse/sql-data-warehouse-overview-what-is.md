<properties
   pageTitle="Что такое хранилище данных SQL Azure? | Microsoft Azure"
   description="Распределенная база данных корпоративного класса, способная обрабатывать петабайты реляционных и нереляционных данных. Это первое облачное хранилище в отрасли, в котором можно увеличивать и уменьшать количество вычислительных ресурсов, а также приостанавливать их работу в считанные секунды."
   services="sql-data-warehouse"
   documentationCenter="NA"
   authors="lodipalm"
   manager="barbkess"
   editor=""/>

<tags
   ms.service="sql-data-warehouse"
   ms.devlang="NA"
   ms.topic="get-started-article"
   ms.tgt_pltfrm="NA"
   ms.workload="data-services"
   ms.date="09/27/2016"
   ms.author="lodipalm;barbkess;mausher;jrj;sonyama;kevin"/>


# Что такое хранилище данных SQL Azure?

Хранилище данных SQL Azure — это развернутая в облаке база данных, способная обрабатывать большие объемы реляционных и нереляционных данных. Опираясь на архитектуру вычислений с массовым параллелизмом (MPP), хранилище данных SQL может обрабатывать рабочую нагрузку целого предприятия.

Преимущества хранилища данных SQL:

- Объединяет возможности реляционной базы данных SQL Server и возможности развертывания в облаке Azure. За считанные секунды вычисления можно масштабировать, приостанавливать или возобновлять. Это позволяет сократить затраты благодаря развертыванию ЦП по необходимости и сокращению использования в периоды минимальной загрузки.
- Использует платформу Azure. Это обеспечивает простоту развертывания и поддержки, а также полную отказоустойчивость благодаря автоматическому резервному копированию.
- Дополняет экосистему SQL Server. При разработке можно использовать знакомые средства SQL Server и Transact-SQL (T-SQL).

В этой статье описаны основные возможности хранилища данных SQL.

## Архитектура вычислений с массовым параллелизмом

Хранилище данных SQL является распределенной системой баз данных с массовой параллельной обработкой (MPP). Распределяя данные и возможности обработки между несколькими узлами, хранилище данных SQL может предложить огромную масштабируемость — намного больше любой единой системы. Хранилище данных SQL неявно распределяет данные по многим хранилищам и объектам обработки, не использующим общие ресурсы. Данные хранятся в локально избыточном хранилище класса Premium. Они связываются с вычислительными узлами для выполнения запросов. Благодаря такой архитектуре при выполнении нагрузки и сложных запросов хранилище данных SQL использует метод разобщения. Запросы, полученные управляющим узлом, оптимизируются, а затем передаются в вычислительные узлы для работы в параллельном режиме.

Благодаря объединению архитектуры MPP и функций службы хранилища Azure хранилище данных SQL обеспечивает следующие возможности:

- увеличение или уменьшение размера хранилища независимо от вычислений;
- увеличение или уменьшение масштаба вычислений без перемещения данных;
- приостановка вычислений без изменения данных;
- моментальное возобновление вычислений.

На следующей схеме эта архитектура показана более подробно.

![Архитектура хранилища данных SQL][1]


**Управляющий узел**. Отвечает за управление запросами и их оптимизацию. Это внешний интерфейс, который взаимодействует со всеми приложениями и подключениями. Управляющий узел в хранилище данных SQL работает на платформе базы данных SQL, и подключение к нему выполняется соответствующим образом. Управляющий узел скрыто координирует все перемещения данных и вычисления, необходимые для выполнения параллельных запросов к распределенным данным. При отправке T-SQL-запроса в хранилище данных SQL управляющий узел преобразует его в отдельные запросы, которые будут выполняться на каждом вычислительном узле в параллельном режиме.

**Вычислительные узлы**. Главный ресурс хранилища данных SQL. Это базы данных SQL, которые хранят данные и обрабатывают запросы. При добавлении данных хранилище данных SQL распределяет строки между вычислительными узлами. Вычислительные узлы также являются рабочими узлами, выполняющими параллельные запросы к данным. После обработки они передают результаты обратно на управляющий узел. Чтобы завершить запрос, управляющий узел объединяет результаты и возвращает конечный результат.

**Хранилище**. Данные хранятся в хранилище BLOB-объектов Azure. Когда вычислительные узлы взаимодействуют с данными, они выполняют запись и чтение непосредственно в хранилище BLOB-объектов. Так как служба хранилища Azure расширяется прозрачно и бесконечно, хранилище данных SQL обладает теми же свойствами. Вычисления и хранение данных не зависят друг от друга, поэтому хранилище данных SQL может автоматически масштабировать хранилище отдельно от масштабирования вычислений, и наоборот. Хранилище BLOB-объектов Azure также полностью отказоустойчиво и упрощает процесс резервного копирования и восстановления.

**Служба перемещения данных** (DMS) перемещает данные между узлами. DMS обеспечивает доступ вычислительных узлов к данным, необходимым для операций объединения и агрегирования. DMS не относится к службам Azure. Это служба Windows, которая работает вместе с базой данных SQL на всех узлах. Так как служба DMS выполняется в фоновом режиме, вам не придется взаимодействовать с ней напрямую. Тем не менее, взглянув на планы запросов, можно заметить, что они включают некоторые операции DMS, так как перемещение данных требуется для выполнения каждого запроса в параллельном режиме.


## Оптимизация для рабочих нагрузок хранилища данных

Подход с использованием MPP поддерживает разные средства оптимизации производительности, в том числе такие:

- Оптимизатор распределенных запросов и сложный статистический набор для всех данных. Информация о размере данных и их распределении помогает службе оптимизировать запросы. Для этого используется оценка стоимости конкретных распределенных операций с запросами.

- Усовершенствованные алгоритмы и методы, интегрированные в процесс перемещения данных, которые эффективно перемещают данные между вычислительными ресурсами в зависимости от потребности в выполнении запроса. Эти операции перемещения данных являются встроенными, а оптимизация службы перемещения данных происходит автоматически.

- Кластеризованные индексы **columnstore** (по умолчанию). В хранилище данных SQL, где принцип хранения данных основан на столбцах, наблюдается пятикратное (в среднем) увеличение сжатия данных (по сравнению с хранилищем с традиционным построчным хранением) и десятикратное (и более) увеличение производительности запросов. Аналитические запросы, которым необходимо сканировать большое количество строк, отлично работают в индексах columnstore.


## Прогнозируемая и масштабируемая производительность

Хранилище данных SQL разделяет хранилище и вычислительные ресурсы, что позволяет масштабировать их независимо друг от друга. Хранилище данных SQL может быстро и просто выполнять масштабирование, благодаря чему можно добавлять дополнительные вычислительные ресурсы в кратчайшие сроки. Это преимущество дополняет использование хранилища BLOB-объектов Azure. Большие двоичные объекты не только являются залогом стабильного реплицированного хранилища, но также формируют инфраструктуру для легкого расширения по низкой цене. Использование масштабируемого облачного хранилища вместе с вычислительными ресурсами Azure в хранилище данных SQL позволяет платить за использование хранилища запросов по мере необходимости. Чтобы изменить объем вычислений, достаточно всего лишь переместить соответствующий ползунок на портале Azure вправо или влево. Кроме того, вычисления можно планировать, используя T-SQL и PowerShell.

Благодаря возможности полностью контролировать вычислительные ресурсы независимо от хранилища хранилище данных SQL позволяет вам полностью приостановить использование своего хранилища данных. Это значит, что вы не будете платить за вычислительные ресурсы, когда они не используются. При этом хранилище останется на своем месте, а все вычисления помещаются в основной пул Azure, что обеспечивает экономию денег. При необходимости просто возобновите использование вычислительных ресурсов и сделайте свои данные и вычислительные ресурсы доступными для рабочей нагрузки.

## Единицы использования хранилища данных

Распределение ресурсов в хранилище данных SQL измеряется в единицах использования хранилища данных (DWU). DWU — это единицы измерения основных ресурсов, таких как ЦП, память, операции ввода/вывода, выделяемых для хранилища данных SQL. Увеличение числа DWU увеличивает объем ресурсов и производительность. В частности, они обеспечивают такие возможности:

- быстрое масштабирование хранилища без привязки к базовому оборудованию или программному обеспечению;

- прогнозирование роста производительности на основе уровня DWU до изменения размера хранилища данных;

- изменение или перемещение базового оборудования и программного обеспечения экземпляра без влияния на производительность при рабочей нагрузке;

- настройка базовой архитектуры службы специалистами корпорации Майкрософт без влияния на производительность при рабочей нагрузке;

- повышение производительности, обеспечивающее масштабируемость системы и равномерное влияние (благодаря возможности быстрого повышения производительности в хранилище данных SQL).

Единицы использования хранилища данных рассматриваются в качестве единиц измерения трех точных метрик, которые тесно связаны с производительностью при рабочей нагрузке хранилища данных. Наша цель — линейное масштабирование основных метрик рабочей нагрузки в соответствии с выбранными для хранилища данных DWU.

**Сканирование или объединение.** Эта метрика рабочей нагрузки использует стандартный запрос хранения данных, который сканирует большое количество строк, а затем выполняет сложное объединение. Эта операция требует большого количества операций ввода-вывода и интенсивного использования ЦП.

**Загрузка.** Эта метрика отображает возможность приема данных в службе. Во время завершения загрузки PolyBase загружает репрезентативный набор данных из хранилища BLOB-объектов Azure. Эта метрика предназначена для тестирования нагрузки сети и ЦП службы.

**Create Table As Select (CTAS)** измеряет возможность копирования таблицы. Эта функция предусматривает чтение данных из хранилища, их распространение по различным узлам устройства и повторную запись в хранилище. Она требует интенсивного использования ЦП и сети, а также большого количества операций ввода/вывода.

## Приостановка и масштабирование по требованию

Если вы хотите получить результаты быстрее, увеличьте количество DWU за отдельную оплату. Если вам не нужна большая вычислительная мощность, уменьшите количество DWU и оплачивайте только необходимые ресурсы. Вы можете изменить количество DWU в таких ситуациях:

- Если вам не нужно выполнять запросы, например в вечернее время или в выходные дни, вы можете приостановить этот процесс. Затем можно приостановить использование связанных вычислительных ресурсов, чтобы не платить за неиспользуемые DWU.

- Если система загружена ниже обычного, рекомендуется сократить DWU. Вы можете получить доступ к данным без лишних затрат со своей стороны.

- Если при выполнении ресурсоемкой загрузки данных или их преобразовании нужно увеличить масштаб, чтобы получить данные быстрее.

Чтобы определить оптимальное значение DWU, попробуйте увеличить и уменьшить масштаб, а также выполнить несколько запросов после загрузки данных. Так как масштабирование выполняется достаточно быстро, попробуйте использовать разные уровни производительности не дольше одного часа. Помните о том, что хранилище данных SQL предназначено для обработки больших объемов данных. Чтобы определить реальные возможности масштабирования (для больших объемов данных, как мы и предлагаем), вы можете использовать большой набор данных, размер которого достигает или превышает 1 ТБ.


## На основе SQL Server

Хранилище данных SQL работает на основе ядра реляционной СУБД и предусматривает множество функций, необходимых для работы с корпоративным хранилищем данных. Если вы уже знакомы с T-SQL, вы можете легко применить свои знания при работе с хранилищем данных SQL. Примеры в документации помогут вам начать работу, независимо от того, есть ли у вас опыт или вы только приступаете к работе с хранилищем. В целом при разработке элементов языка для хранилища данных SQL мы предусмотрели следующие принципы:

- Хранилище данных SQL использует синтаксис T-SQL для выполнения многих операций. Оно также поддерживает широкий набор традиционных конструкций SQL, например хранимые процедуры, пользовательские функции, секционирование таблиц, индексы и параметры сортировки.

- Хранилище данных SQL также включает в себя новые функции SQL Server, в том числе кластеризованные индексы **columnstore**, интеграцию PolyBase и аудит данных (предусматривающий также оценку угроз).

- Некоторые элементы языка Transact-SQL используются не во всех рабочих нагрузках хранилищ данных, а только в более новых версиях SQL Server. Сейчас эти элементы могут быть недоступны. Дополнительные сведения см. в [документации по миграции][].

Используя Transact-SQL и схожесть функций между SQL Server, хранилищем данных SQL, базой данных SQL и системой аналитических платформ, можно разрабатывать решения, которые соответствуют вашим требованиям к хранению и обработке данных. Вы можете выбрать место для хранения данных, исходя из требований к производительности, безопасности и масштабированию, а затем переносить данные между разными системами.

## Защита данных

Все данные хранилища данных SQL хранятся в локально избыточном хранилище Azure класса Premium. Несколько синхронных копий данных сохраняются в локальном центре обработки данных для обеспечения прозрачной защиты данных в случае локальных сбоев. Кроме того, хранилище данных SQL автоматически создает резервные копии активных (используемых) баз данных через регулярные промежутки времени, используя моментальные снимки службы хранилища Azure. Сведения о резервном копировании и восстановлении см. [здесь][].

## Интеграция с помощью средств Майкрософт

Хранилище данных SQL также интегрируется со многими знакомыми пользователям средствами SQL Server. В частности, описаны такие возможности:

**Традиционные средства SQL Server**. Хранилище данных SQL полностью интегрировано со службами SQL Server Analysis Services, Integration Services и Reporting Services.

**Облачные инструменты**. Хранилище данных SQL можно использовать с рядом новых инструментов в Azure, включая фабрику данных, Stream Analytics, машинное обучение и Power BI. Полный список см. в [обзоре интегрированных средств][].

**Сторонние инструменты**. Сертифицированную интеграцию с хранилищем данных SQL поддерживает большое количество сторонних инструментов. Полный список см. в статье [Партнеры по бизнес-аналитике хранилища данных SQL][].

## Сценарии для гибридных источников данных

Хранилище данных SQL с PolyBase позволяет переносить данные в пределах своей экосистемы, что ранее было недоступно. Это, в свою очередь, позволяет настраивать расширенные гибридные сценарии, предусматривающие использование нереляционных локальных источников данных.

Технология PolyBase обеспечивает использование данных из различных источников, выполняя уже знакомые команды T-SQL. PolyBase позволяет отправлять запросы на нереляционные данные, которые находятся в хранилище BLOB-объектов Azure, как если бы они находились в обычной таблице. С помощью Polybase можно отправлять запросы к нереляционным данным или импортировать такие данные в хранилище данных SQL.

- Для доступа к нереляционным данным технология PolyBase использует внешние таблицы. Определения таблиц находятся в хранилище данных SQL. Их можно открывать с помощью SQL и любых других инструментов, подобно обычным реляционным данным.

- Интеграция Polybase не зависит используемых технологий. PolyBase предоставляет одинаковые компоненты и функциональные возможности для всех поддерживаемых ресурсов. Технология Polybase позволяет читать данные в различных форматах, включая файлы с разделителями и ORC-файлы.

- PolyBase можно использовать для доступа к хранилищу BLOB-объектов, которое также может служить хранилищем кластера HD Insight. Таким образом вы получаете доступ к одним и тем же данным как с помощью реляционных, так и нереляционных инструментов.

## Дальнейшие действия

Теперь, когда вам уже известны некоторые сведения о хранилище данных SQL, узнайте о том, как [создать хранилище данных SQL][] и [загрузить демонстрационные данные][]. Если вы раньше не работали с Azure, используйте [глоссарий Azure Глоссарий][], чтобы узнать значение новых терминов. Или ознакомьтесь со следующими ресурсами, посвященными хранилищу данных SQL.

- [Истории успеха клиентов]
- [Блоги]
- [Запросы функций]
- [Видеоролики]
- [Блоги группы консультирования клиентов]
- [Создание запроса в службу поддержки]
- [Форум MSDN]
- [Форум Stack Overflow]
- [Twitter]


<!--Image references-->
[1]: ./media/sql-data-warehouse-overview-what-is/dwarchitecture.png

.<!--Article references-->
[Создание запроса в службу поддержки]: ./sql-data-warehouse-get-started-create-support-ticket.md
[загрузить демонстрационные данные]: ./sql-data-warehouse-load-sample-databases.md
[создать хранилище данных SQL]: ./sql-data-warehouse-get-started-provision.md
[документации по миграции]: ./sql-data-warehouse-overview-migrate.md
[Партнеры по бизнес-аналитике хранилища данных SQL]: ./sql-data-warehouse-partner-business-intelligence.md
[обзоре интегрированных средств]: ./sql-data-warehouse-overview-integrate.md
[здесь]: ./sql-data-warehouse-restore-database-overview.md
[глоссарий Azure Глоссарий]: ../azure-glossary-cloud-terminology.md

.<!--MSDN references-->

<!--Other Web references-->
[Истории успеха клиентов]: https://customers.microsoft.com/search?sq=&ff=story_products_services%26%3EAzure%2FAzure%2FAzure%20SQL%20Data%20Warehouse%26%26story_product_families%26%3EAzure%2FAzure%26%26story_product_categories%26%3EAzure&p=0
[Блоги]: https://azure.microsoft.com/blog/tag/azure-sql-data-warehouse/
[Блоги группы консультирования клиентов]: https://blogs.msdn.microsoft.com/sqlcat/tag/sql-dw/
[Запросы функций]: https://feedback.azure.com/forums/307516-sql-data-warehouse
[Форум MSDN]: https://social.msdn.microsoft.com/Forums/azure/ru-RU/home?forum=AzureSQLDataWarehouse
[Форум Stack Overflow]: http://stackoverflow.com/questions/tagged/azure-sqldw
[Twitter]: https://twitter.com/hashtag/SQLDW
[Видеоролики]: https://azure.microsoft.com/documentation/videos/index/?services=sql-data-warehouse

<!---HONumber=AcomDC_0928_2016-->