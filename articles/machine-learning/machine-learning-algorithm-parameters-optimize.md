<properties 
	pageTitle="Как выбрать параметры для оптимизации алгоритмов в Машинном обучении Azure | Microsoft Azure" 
	description="В этой статье содержится информация о том, как выбрать оптимальный набор параметров для алгоритма в Машинном обучении Azure." 
	services="machine-learning"
	documentationCenter="" 
	authors="bradsev" 
	manager="jhubbard" 
	editor="cgronlun"/>

<tags 
	ms.service="machine-learning" 
	ms.workload="data-services" 
	ms.tgt_pltfrm="na" 
	ms.devlang="na" 
	ms.topic="article" 
	ms.date="09/12/2016" 
	ms.author="bradsev" />


# Как выбрать параметры для оптимизации алгоритмов в Машинном обучении Azure

В этой статье описывается, как выбрать правильный набор гиперпараметров для алгоритма в Машинном обучении Azure. В большинстве алгоритмов машинного обучения есть параметры, которые необходимо настроить. При обучении модели необходимо задать значения для этих параметров. Эффективность обученной модели зависит от выбираемых для нее параметров. Процесс определения оптимального набора параметров называется выбором модели.

[AZURE.INCLUDE [machine-learning-free-trial](../../includes/machine-learning-free-trial.md)]

Модель можно выбрать несколькими способами. Один из наиболее часто используемых методов выбора модели в машинном обучении — перекрестная проверка. Этот метод также является механизмом выбора модели по умолчанию в Машинном обучении Azure. Так как в Машинном обучении Azure поддерживается как язык R, так и Python, вы всегда можете реализовать собственный механизм выбора модели, используя один из этих языков.

Существует четыре этапа определения оптимального набора параметров.

1.	**Определение пространства параметров**: сначала мы определяем точные значения параметров, которые нужно учесть для алгоритма.
2.	**Определение параметров перекрестной проверки**: далее нам необходимо определить способ выбора сверток перекрестной проверки для набора данных.
3.	**Определение метрики**: затем нужно выбрать метрику, которая будет использоваться для определения оптимального набора параметров, таких как точность, среднеквадратическая погрешность, прецизионность, отзыв или F-оценка.
4.	**Обучение, оценка и сравнение**: после этого для каждого уникального сочетания значений параметров на основе выбранной пользователем метрики погрешности выполняется перекрестная проверка. На этом этапе можно выбрать оптимальную для выполнения модель.

В следующем эксперименте показано, как это можно сделать в Машинном обучении Azure.

![рисунок 1](./media/machine-learning-algorithm-parameters-optimize/fig1.png)
 
## Определение пространства параметров
Набор параметров можно определить на этапе инициализации модели. На панели параметров всех алгоритмов машинного обучения есть два режима учителя: **Один параметр** и **Диапазон параметров**. Нам необходимо выбрать режим **Диапазон параметров** (см. рис. 1). Этот режим позволяет вводить несколько значений для каждого параметра. Значения можно ввести в текстовое поле через запятую. В качестве альтернативы для определения минимального и максимального количества точек в сетке, а также общего количества создаваемых точек можно использовать параметр **Использовать построитель диапазонов**. По умолчанию значения параметров отображаются на линейной шкале. Но если установлен флажок **Логарифмическая шкала**, то значения будут отображаться на логарифмической шкале (т. е. соотношение соседних точек остается стабильным и не меняется). Для параметров целочисленного типа диапазон можно определить с помощью дефиса «-», например "1-10". В этом примере все целые числа от 1 до 10 (включая оба этих числа) образуют набор параметров. Также поддерживается смешанный режим, например "1-10, 20, 50". В этом случае, помимо чисел от 1 до 10, в набор параметров также будут добавлены числа 20 и 50.
  
![рисунок 2](./media/machine-learning-algorithm-parameters-optimize/fig2.png) ![image3](./media/machine-learning-algorithm-parameters-optimize/fig3.png)

## Определение свертки перекрестной проверки
Модуль [Секционирование и выборка][partition-and-sample] используется для назначения сверток данным в случайном порядке. На следующем рисунке показан пример конфигурации для модуля, где в качестве количества сверток задано число 5 и выбран параметр случайного присвоения номеров сверток экземплярам выборки.

![image4](./media/machine-learning-algorithm-parameters-optimize/fig4.png)


## Определение метрики
Модуль [Гиперпараметры модели настройки][tune-model-hyperparameters] позволяет эмпирически выбрать оптимальный набор параметров для заданного алгоритма и набора данных. Помимо другой информации, касающейся обучения модели, на панели свойств этого модуля содержится метрика, которая используется для определения оптимального набора параметров. На этой панели также есть два разных раскрывающихся списка для алгоритмов классификации и регрессии соответственно. Если рассматривается алгоритм классификации, то метрика регрессии игнорируется и наоборот. В этом примере в качестве метрики выбрана **Точность**.
 
![рисунок 5](./media/machine-learning-algorithm-parameters-optimize/fig5.png)

## Обучение, оценка и сравнение  
Тот же модуль [Tune Model Hyperparameters][tune-model-hyperparameters] \(Гиперпараметры модели настройки) обучает все модели, которые соответствуют набору параметров, оценивает различные метрики, а затем выводит оптимально обученную модель на основе выбранной вами метрики. Для этого модуля необходимо обязательно предоставить следующие входные данные:

* необученный ученик;
* набор данных.

Для модуля также можно указать дополнительный набор данных. Мы подключаем набор данных с информацией о свертке к обязательному набору данных. Если для набора данных не назначена информация о свертке, по умолчанию будет автоматически выполняться перекрестная проверка 10 сверток. Если свертка не назначена, а на дополнительный порт набора данных подан проверочный набор данных, то будет выбран режим тестового обучения, при котором первый набор данных используется для обучения модели с каждым сочетанием параметров. А затем в проверочном наборе данных выполняется оценка модели. Левый порт вывода модуля отображает различные метрики в качестве функции значений параметров. Правый порт вывода предоставляет обученную модель, соответствующую оптимальной модели, по каждой выбранной метрике (в данном случае — точности).

![рисунок 6](./media/machine-learning-algorithm-parameters-optimize/fig6a.png) ![рисунок 7](./media/machine-learning-algorithm-parameters-optimize/fig6b.png)
 
Чтобы увидеть точные выбранные параметры, необходимо выполнить визуализацию правого порта вывода. Эту модель можно использовать для оценки проверочного набора или в развернутой веб-службе после сохранения обученной модели.


<!-- Module References -->
[partition-and-sample]: https://msdn.microsoft.com/library/azure/a8726e34-1b3e-4515-b59a-3e4a475654b8/
[tune-model-hyperparameters]: https://msdn.microsoft.com/library/azure/038d91b6-c2f2-42a1-9215-1f2c20ed1b40/
 

<!---HONumber=AcomDC_0914_2016-->