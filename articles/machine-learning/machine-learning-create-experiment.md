<properties
	pageTitle="Простой эксперимент в Студии машинного обучения | Microsoft Azure"
	description="В этом пошаговом руководстве по машинному обучению описано, как создать простой эксперимент по обработке и анализу данных. Мы предскажем цену автомобиля, используя алгоритм регрессии."
	keywords="эксперимент,линейная регрессия,алгоритмы машинного обучения,руководство по машинному обучению,приемы прогнозного моделирования,эксперимент по обработке и анализу данных"
	services="machine-learning"
	documentationCenter=""
	authors="garyericson"
	manager="jhubbard"
	editor="cgronlun"/>

<tags
	ms.service="machine-learning"
	ms.workload="data-services"
	ms.tgt_pltfrm="na"
	ms.devlang="na"
	ms.topic="hero-article"
	ms.date="07/14/2016"
	ms.author="garye"/>

# Руководство по машинному обучению. Создание первого эксперимента по обработке и анализу данных в Студии машинного обучения Azure

В этом пошаговом руководстве по машинному обучению описано, как создать простой эксперимент по обработке и анализу данных. Мы создадим модель линейной регрессии, которая позволит спрогнозировать стоимость автомобиля на основе таких переменных, как марка и технические характеристики. Мы воспользуемся Студией машинного обучения Azure для разработки и выполнения итерации простого эксперимента по прогнозной аналитике.

*Прогнозная аналитика* является разновидностью обработки и анализа данных, в которой текущие данные используются для прогнозирования будущих результатов. Самый простой пример прогнозной аналитики показан в видео 4 из цикла "Обработка и анализ данных для начинающих" [Прогнозирование ответа с помощью простой модели.](machine-learning-data-science-for-beginners-predict-an-answer-with-a-simple-model.md) (длительность — 7:42).

[AZURE.INCLUDE [machine-learning-free-trial](../../includes/machine-learning-free-trial.md)]

## Как работает Студия машинного обучения?

Студия машинного обучения позволяет без усилий настроить эксперимент с помощью перетаскиваемых модулей, предварительно запрограммированных с помощью методик прогнозного моделирования. Чтобы запустить эксперимент и спрогнозировать ответ, следует *создать*, *обучить*, *оценить и проверить модель* в Студии машинного обучения.

Войдите в Студию машинного обучения на странице [https://studio.azureml.net](https://studio.azureml.net). Если вы уже вошли в Студию машинного обучения, щелкните **Войти здесь**. В противном случае щелкните **Регистрация** и выберите один из бесплатных или платных вариантов.

Общую информацию о Студии машинного обучения см. в статье [Что такое Студия машинного обучения Azure](machine-learning-what-is-ml-studio.md).

## Пять шагов для создания эксперимента

В этой статье мы создадим эксперимент в Студии машинного обучения за пять основных шагов, которые предусматривают создание, обучение и оценку модели.

- Создание модели
	- [Шаг 1. Получение данных]
	- [Шаг 2. Предварительная обработка данных]
	- [Шаг 3. Определение признаков]
- Обучение модели
	- [Шаг 4. Выбор и применение алгоритма обучения]
- Оценка и тестирование модели
	- [Шаг 5. Прогнозирование цен на новые автомобили]

[Шаг 1. Получение данных]: #step-1-get-data
[Шаг 2. Предварительная обработка данных]: #step-2-preprocess-data
[Шаг 3. Определение признаков]: #step-3-define-features
[Шаг 4. Выбор и применение алгоритма обучения]: #step-4-choose-and-apply-a-learning-algorithm
[Шаг 5. Прогнозирование цен на новые автомобили]: #step-5-predict-new-automobile-prices


## Шаг 1. Получение данных

В комплект поставки Студии машинного обучения входят несколько примеров наборов данных на выбор. Данные также можно импортировать из множества источников. Для данного примера мы воспользуемся комплектным примером набора данных **Данные о ценах на автомобили (необработанные)**. В этом наборе данных содержатся записи для определенного количества автомобилей, включая такую информацию, как дата производства, модель, технические характеристики и цена.

1. Запустите новый эксперимент, щелкнув **+СОЗДАТЬ** в нижней части окна студии машинного обучения, и выберите **ЭКСПЕРИМЕНТ**, а затем — **Пустой эксперимент**. В верхней части холста выберите имя эксперимента по умолчанию и присвойте ему понятное имя, например **Прогнозирование цен на автомобили**.

2. В левой части области эксперимента расположена выборка данных и модулей. Введите значение **автомобили** в поле поиска в верхней части палитры и найдите набор данных с названием **Данные о ценах на автомобили (необработанные)**.

	![Поиск в палитре][screen1a]

3. Перетащите выборку в область эксперимента.

	![Выборка][screen1]

Чтобы просмотреть, как выглядят эти данные, щелкните порт вывода в нижней части набора данных по автомобилям и выберите **Визуализировать**.

![Порт вывода модуля][screen1c]

Переменные в выборке выводятся в виде столбцов, каждый экземпляр автомобиля — в виде строк. Крайний правый столбец (столбец 26 с именем "Цена") — это та переменная, которую мы собираемся спрогнозировать.

![Визуализация выборки данных][screen1b]

Закройте окно визуализации, нажав «**x**» в правом верхнем углу.

## Шаг 2. Предварительная обработка данных

Перед анализом, как правило, требуется определенная предварительная обработка набора данных. Вы могли заметить, что в столбцах некоторых строк отсутствуют значения. Чтобы модель смогла правильно проанализировать данные, необходимо очистить эти недостающие значения. В нашем случае мы удалим все строки, в которых есть недостающие значения. В столбце **Нормированные потери** также есть значительная доля недостающих значений, поэтому мы исключим весь этот столбец из модели.

> [AZURE.TIP] Удаление недостающих значений из входных данных является необходимым условием для использования большинства модулей.

Сначала мы удалим столбец **Нормированные потери**, а затем удалим все строки с недостающими данными.

1. Введите **выбор столбцов** в поле поиска в верхней части палитры модулей, чтобы найти модуль [выбора столбцов в наборе данных][select-columns]. Затем перетащите модуль на холст эксперимента и подключите его к порту вывода набора данных **Данные о ценах на автомобили (необработанные)**. Этот модуль позволяет выбрать, какие столбцы данных нужно включить в модель или исключить из нее.

2. Выберите модуль [выбора столбцов в наборе данных][select-columns] и в области **Свойства** щелкните **Launch column selector** (Запустить средство выбора столбцов).

	- Слева щелкните **With rules** (С правилами).
	- В разделе **Начинаются с** нажмите кнопку **Все столбцы**. В этом случае модуль [выбора столбцов в наборе данных][select-columns] будет обрабатывать все столбцы (кроме тех, которые мы собираемся исключить).
	- В раскрывающихся списках выберите **Исключить** и **Имена столбцов**, а затем щелкните внутри текстового поля. Отобразится список столбцов. Выберите элемент **нормированные потери**, после чего этот столбец будет добавлен в текстовое поле.
	- Нажмите кнопку "ОК", чтобы закрыть средство выбора столбцов.

    ![Выбор столбцов][screen3]

	Область свойств модуля **выбора столбцов в наборе данных** показывает, что будут обрабатываться все столбцы набора данных, за исключением столбца **нормированных потерь**.

    ![Свойства модуля выбора столбцов в наборе данных][screen4]

    > [AZURE.TIP] Дважды щелкните модуль и введите текст, чтобы добавить комментарий. Это поможет вам увидеть описание модуля и его действие в рамках эксперимента. В этом случае дважды щелкните модуль [выбора столбцов в наборе данных][select-columns] и введите комментарий об исключении столбца нормированных потерь.

3. Перетащите на холст эксперимента модуль [очистки отсутствующих данных][clean-missing-data] и подключите его к модулю [выбора столбцов в наборе данных][select-columns]. В области **Свойства** выберите **Удалить строку полностью** в раскрывающемся списке **Режим очистки**, чтобы очистить данные путем удаления строк, содержащих недостающие значения. Дважды щелкните модуль и введите комментарий "Удаление строк с недостающими значениями".

	![Свойства модуля "Очистка недостающих данных"][screen4a]

4. Запустите эксперимент, щелкнув **ПУСК** под холстом эксперимента.

После завершения эксперимента у всех модулей должен появиться зеленый флажок, означающий их успешное завершение. Обратите также внимание на состояние **Работа завершена** в правом верхнем углу.

![Первый запуск эксперимента][screen5]

Все, что мы выполнили в эксперименте до этого момента, — это очистка данных. Чтобы просмотреть очищенный набор данных, щелкните левый порт вывода модуля [Очистка недостающих данных][clean-missing-data] \(«Очищенный набор данных») и выберите **Визуализировать**. Обратите внимание, что столбца **Нормированные потери** больше нет. Кроме того, теперь нет недостающих значений.

После очистки данных мы готовы к заданию свойств, которые будут использоваться в прогнозной модели.

## Шаг 3. Определение признаков

В машинном обучении *признаки* — это отдельные измеримые свойства интересующих объектов. В нашем наборе данных каждая строка представляет собой один автомобиль, а каждый столбец — его признак.

Чтобы подобрать подходящий набор признаков для создания прогнозной модели, нужно разбираться в проблеме, которую необходимо решить, и провести ряд экспериментов. Некоторые свойства лучше подходят для прогнозирования цели, чем другие. Кроме того, некоторые признаки сильно коррелируют с другими признаками (например, расход топлива при движении по городу и при движении по шоссе). Таким образом, они не добавят много новой информации в модель, и их можно удалить.

Давайте создадим модель, которая использует подмножество свойств в нашей выборке. Можно вернуться назад и выбрать различные свойства, заново запустить эксперимент и оценить результаты. Но для начала давайте попробуем следующие возможности.

	make, body-style, wheel-base, engine-size, horsepower, peak-rpm, highway-mpg, price


1. Перетащите на холст эксперимента еще один модуль [выбора столбцов в наборе данных][select-columns] и подключите его к левому порту вывода модуля [очистки отсутствующих данных][clean-missing-data]. Дважды щелкните модуль и введите: "Выбор признаков для прогнозирования".

2. В области **Свойства** щелкните **Запустить средство выбора столбцов**.

3. Щелкните **With rules** (С правилами).

4. В разделе **Начинаются с** выберите **Нет столбцов**, а затем выберите **Включить** и **Имена столбцов** в строке фильтра. Введите наш список столбцов. В этом случае модуль будет передавать на вывод только указанные нами столбцы.

	> [AZURE.TIP] Запустив этот эксперимент, мы убедились, что определения столбцов для наших данных передаются из исходного набора данных через модуль [очистки отсутствующих данных][clean-missing-data]. Это означает, что другие модули, которые вы подключите, также будут содержать информацию из набора данных.

5. Щелкните значок с изображением флажка (кнопка "ОК").

![Выбор столбцов][screen6]

В результате получится набор данных, который будет использоваться в алгоритме обучения на последующих этапах. Позже вы сможете вернуться назад и заново попробовать выбрать другой набор признаков.

## Шаг 4. Выбор и применение алгоритма обучения

Теперь, когда данные готовы, процесс построения прогнозной модели состоит из обучения и тестирования. Сначала мы используем данные для обучения модели, а затем для ее тестирования, чтобы увидеть, насколько точно она может прогнозировать цены. Пока не беспокойтесь о том, зачем нам нужно обучить и проверить модель.

*Классификация* и *регрессия* — это два типа методов машинного обучения с учителем. Классификация используется, чтобы сформировать прогноз по заданному набору категорий, таких как цвет (красный, синий, или зеленый). Регрессия используется для прогнозирования числа.

Мы хотим предсказать цену, которая является числом, поэтому будем использовать модель регрессии. Для этого примера мы будем обучать простую модель *линейной регрессии* и на следующем этапе будем тестировать ее.

1. Мы используем данные и для обучения, и для тестирования, разделив их на отдельные наборы для обучения и тестирования. Выберите и перетащите в область эксперимента модуль [разделения данных][split], а затем подключите его к выходу модуля [выбора столбцов в наборе данных][select-columns]. Установите значение параметра **Доля строк в первой выходной выборке** в 0,75. Таким образом, мы используем 75 процентов данных для обучения модели и оставим 25 процентов для тестирования.

	> [AZURE.TIP] Изменяя параметр **Псевдослучайные числа**, вы можете создавать различные случайные выборки для обучения и тестирования. Этот параметр задает начальное значение для генератора псевдослучайных чисел.

2. Запустите эксперимент. При этом модули [выбора столбцов в наборе данных][select-columns] и [разделения данных][split] передают определения столбцов в модули, которые будут добавлены на следующем этапе.

3. Для выбора алгоритма обучения разверните категорию **Машинное обучение** на палитре модулей слева на холсте эксперимента, а затем разверните **Инициализировать модель**. Появится несколько категорий модулей, которые можно использовать для инициализации алгоритма обучения.

	Для эксперимента выберите модуль [Линейная регрессия][linear-regression] в категории **Регрессия** (чтобы его найти, также можно ввести «Линейная регрессия» в поле поиска палитры) и перетащите его на холст эксперимента.

4. Найдите и переместите модуль [Обучение модели][train-model] на холст эксперимента. Подключите левый порт ввода к порту вывода модуля [Линейная регрессия][linear-regression]. Подключите правый порт ввода к порту вывода данных для обучения (левому порту) модуля [Разделение данных][split].

5. Выберите модуль [Обучение модели][train-model], щелкните элемент **Запустить средство выбора столбцов** в области **Свойства** и выберите столбец **цена**. Это значение, которое наша модель собирается спрогнозировать.

	![Выберите столбец "Цена"][screen7]

6. Запустите эксперимент.

В результате получим обученную регрессионную модель, которую можно использовать для оценки новых значений с целью прогнозирования.

![Применение алгоритма машинного обучения][screen8]

## Шаг 5. Прогнозирование цен на новые автомобили

После того как мы обучили модель, использовав 75 процентов наших данных, ее можно использовать для оценки оставшихся 25 процентов данных, чтобы проверить, насколько хорошо она работает.

1. Найдите и перетащите модуль [Оценка модели][score-model] на холст эксперимента и подключите левый порт ввода к порту вывода модуля [Обучение модели][train-model]. Подключите правый порт ввода к выводу тестовых данных (правому порту) модуля [Разделение данных][split].

	![Модуль "Оценка модели"][screen8a]

2. Запустите эксперимент и проверьте выходные данные модуля [Оценка модели][score-model] \(щелкните порт вывода и выберите **Визуализировать**). На порту вывода будут показаны прогнозируемые значения цены вместе с известными значениями проверочных данных.

3. Наконец, чтобы проверить качество результатов, выберите и перетащите модуль [Анализ модели][evaluate-model] на холст эксперимента и подключите левый порт ввода к порту вывода модуля [Оценка модели][score-model]. (Так как модуль [Анализ модели][evaluate-model] можно использовать для сравнения двух моделей, предусмотрено два порта ввода.)

4. Запустите эксперимент.

Чтобы проверить выходные данные модуля [Анализ модели][evaluate-model], щелкните порт вывода и выберите элемент **Визуализировать**. Для нашей модели будет выведена следующая статистика.

- **Среднее арифметическое отклонение** (MAE) — среднее значение арифметических отклонений (*отклонение* — это разница между спрогнозированным значением и его фактическим значением).
- **Среднеквадратичное отклонение** (RMSE) — квадратный корень из среднего значения возведенных в квадрат арифметических отклонений спрогнозированных значений тестового набора данных.
- **Относительное арифметическое отклонение** — среднее арифметическое отклонение по отношению к абсолютной разнице между фактическими значениями и средним арифметическим всех фактических значений.
- **Относительное среднеквадратичное отклонение** — среднее арифметическое среднеквадратичных отклонений по отношению к абсолютной разнице между фактическими значениями и средним арифметическим всех фактических значений.
- **Коэффициент смешанной корреляции** (или **R в квадрате** — статистический показатель, который оценивает соответствие модели данным.

Чем меньше значение каждой погрешности, тем лучше. Меньшее значение указывает на то, что прогноз лучше соответствует фактическим значениям. Для показателя **коэффициент смешанной корреляции** чем ближе его значение к единице (1,0), тем точнее прогноз.

![Результаты оценки][screen9]

В окончательном виде эксперимент должен выглядеть следующим образом:

![Инструкции по созданию эксперимента с линейной регрессией, в котором используются приемы прогнозного моделирования.][screen10]

## Дальнейшие действия

Теперь, когда вы выполнили все инструкции и создали свой собственный эксперимент, попробуйте улучшить свою модель. Например, можно изменить свойства, которые используются в прогнозировании. Либо вы можете изменить свойства алгоритма [Линейной регрессии][linear-regression], либо попробовать использовать вместе с ним другой алгоритм. Вы даже можете добавить в эксперимент несколько алгоритмов сразу и сравнить два из них с помощью модуля [Анализ модели][evaluate-model].

> [AZURE.TIP] Используйте кнопку **СОХРАНИТЬ КАК** под холстом эксперимента, чтобы создать копию любой итерации вашего эксперимента. Вы можете просмотреть все итерации вашего эксперимента, нажав кнопку **ПРОСМОТР ИСТОРИИ ЗАПУСКОВ** под холстом эксперимента. Дополнительную информацию см. в статье [Управление итерациями экспериментов в Студии машинного обучения Azure][runhistory].

[runhistory]: machine-learning-manage-experiment-iterations.md

Если вы удовлетворены результатами своей модели, вы можете развернуть ее в качестве веб-службы, чтобы ее можно было использовать для прогнозирования цен на автомобили, используя новые данные. Дополнительную информацию см. в статье [Развертывание веб-службы машинного обучения Azure][publish].

[publish]: machine-learning-publish-a-machine-learning-web-service.md

Более обширное и подробное пошаговое руководство по приемам прогнозного моделирования для создания, обучения, оценки и развертывания модели см. в статье [Разработка решения прогнозирования с помощью машинного обучения Azure][walkthrough].

[walkthrough]: machine-learning-walkthrough-develop-predictive-solution.md

<!-- Images -->
[screen1]: ./media/machine-learning-create-experiment/screen1.png
[screen1a]: ./media/machine-learning-create-experiment/screen1a.png
[screen1b]: ./media/machine-learning-create-experiment/screen1b.png
[screen1c]: ./media/machine-learning-create-experiment/screen1c.png
[screen2]: ./media/machine-learning-create-experiment/screen2.png
[screen3]: ./media/machine-learning-create-experiment/screen3.png
[screen4]: ./media/machine-learning-create-experiment/screen4.png
[screen4a]: ./media/machine-learning-create-experiment/screen4a.png
[screen5]: ./media/machine-learning-create-experiment/screen5.png
[screen6]: ./media/machine-learning-create-experiment/screen6.png
[screen7]: ./media/machine-learning-create-experiment/screen7.png
[screen8]: ./media/machine-learning-create-experiment/screen8.png
[screen8a]: ./media/machine-learning-create-experiment/screen8a.png
[screen9]: ./media/machine-learning-create-experiment/screen9.png
[screen10]: ./media/machine-learning-create-experiment/complete-linear-regression-experiment.png


<!-- Module References -->
[evaluate-model]: https://msdn.microsoft.com/library/azure/927d65ac-3b50-4694-9903-20f6c1672089/
[linear-regression]: https://msdn.microsoft.com/library/azure/31960a6f-789b-4cf7-88d6-2e1152c0bd1a/
[clean-missing-data]: https://msdn.microsoft.com/library/azure/d2c5ca2f-7323-41a3-9b7e-da917c99f0c4/
[select-columns]: https://msdn.microsoft.com/library/azure/1ec722fa-b623-4e26-a44e-a50c6d726223/
[score-model]: https://msdn.microsoft.com/library/azure/401b4f92-e724-4d5a-be81-d5b0ff9bdb33/
[split]: https://msdn.microsoft.com/library/azure/70530644-c97a-4ab6-85f7-88bf30a8be5f/
[train-model]: https://msdn.microsoft.com/library/azure/5cc7053e-aa30-450d-96c0-dae4be720977/

<!---HONumber=AcomDC_0914_2016-->