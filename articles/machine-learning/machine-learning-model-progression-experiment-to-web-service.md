<properties
	pageTitle="Как модель машинного обучения развивается от эксперимента до рабочей веб-службы | Microsoft Azure"
	description="Обзор механизма развития модели машинного обучения Azure от эксперимента по разработке до рабочей веб-службы."
	services="machine-learning"
	documentationCenter=""
	authors="garyericson"
	manager="jhubbard"
	editor="cgronlun"/>

<tags
	ms.service="machine-learning"
	ms.workload="data-services"
	ms.tgt_pltfrm="na"
	ms.devlang="na"
	ms.topic="article"
	ms.date="07/06/2016"
	ms.author="garye"/>


# Как модель машинного обучения развивается от эксперимента до рабочей веб-службы

***Эксперимент*** представляет собой холст в студии машинного обучения Azure, который позволяет в интерактивном режиме разрабатывать, запускать, тестировать и выполнять итерацию по мере создания модели прогнозной аналитики. Доступен широкий набор модулей, которые можно использовать для добавления данных в эксперимент, управления ими, обучения модели с помощью алгоритмов машинного обучения, оценки модели и результатов, а также для вывода конечных значений.

После завершения эксперимента модель можно развернуть как ***классическую веб-службу Azure*** или ***новую веб-службу Azure***, чтобы пользователи могли отправлять в нее новые данные и получать результаты.

В этой статье описывается механизм развития модели машинного обучения от эксперимента по разработке до рабочей веб-службы.

>[AZURE.NOTE] Существуют и другие способы разработки и развертывания моделей машинного обучения, но в этой статье рассматривается использование студии машинного обучения. Описание способов создания классической прогнозной веб-службы при помощи R см. в записи блога [Build & Deploy Predictive Web Apps Using RStudio and Azure ML](http://blogs.technet.com/b/machinelearning/archive/2015/09/25/build-and-deploy-a-predictive-web-app-using-rstudio-and-azure-ml.aspx) (Создание и развертывание прогнозных веб-приложений с помощью RStudio и Azure ML).

Хотя студия машинного обучения Azure предназначена главным образом для разработки и развертывания *модели прогнозной аналитики*, ее можно использовать для разработки эксперимента, не включающего модель прогнозной аналитики. Например, эксперимент может просто вводить данные, выполнять с ними манипуляции и выдавать результат. Подобно эксперименту прогнозной аналитики, этот эксперимент можно развернуть как веб-службу, но это более простой процесс, поскольку эксперимент не выполняет обучение или оценку модели машинного обучения. Хотя это использование студии не является типичным, мы рассмотрим его ниже, чтобы полностью описать работу студии.

## Разработка и развертывание прогнозной веб-службы

Ниже приведены этапы, выполняемые стандартным решением по мере разработки и развертывания с помощью студии машинного обучения.

![](media\machine-learning-model-progression-experiment-to-web-service\model-stages-from-experiment-to-web-service.png)

*Рис. 1. Этапы типичной модели прогнозной аналитики*

### Обучающий эксперимент

***Обучающий эксперимент*** — это первоначальный холст эксперимента в студии машинного обучения. Обучающий эксперимент предоставляет вам пространство для разработки, тестирования, выполнения итераций и в конечном итоге обучения модели машинного обучения. В процессе поиска наиболее подходящего решения можно обучать несколько моделей одновременно, но после завершения эксперимента нужно будет выбрать одну обученную модель, а остальные удалить из эксперимента. Пример разработки эксперимента прогнозной аналитики см. в разделе [Пошаговое руководство по разработке решения для прогнозной аналитики в службе машинного обучения Azure для оценки кредитных рисков](machine-learning-walkthrough-develop-predictive-solution.md).

### Прогнозный эксперимент

Если в вашем обучающем эксперименте есть обученная модель, в студии машинного обучения нажмите кнопку **Настроить веб-службу**, после чего обучающий эксперимент будет преобразован в ***прогнозный эксперимент***. Цель прогнозного эксперимента заключается в использовании обученной модели для оценки новых данных, чтобы в последствии эта модель стала работающей веб-службой Azure.

Для преобразования выполняются следующие действия:

-   преобразование набора модулей, используемых для обучения, в один модуль и сохранение его как обученной модели;

-   удаление всех лишних модулей, не связанных с оценкой;

-   добавление портов ввода и вывода, которые в дальнейшем будут использоваться веб-службой.

Возможно, вы захотите внести дополнительные изменения, чтобы подготовить прогнозный эксперимент к развертыванию в качестве веб-службы. Например, если необходимо, чтобы веб-служба выводила только подмножество результатов, перед портом вывода можно добавить модуль фильтрования.

В процессе преобразования обучающий эксперимент не удаляется. После завершения процесса в студии будут отображаться две вкладки: одна для обучающего эксперимента и вторая для прогнозного эксперимента. Таким образом, перед развертыванием веб-службы можно внести изменения в обучающий эксперимент и изменить прогнозный эксперимент. Кроме того, можно сохранить копию обучающего эксперимента, чтобы начать новый эксперимент.

>[AZURE.NOTE] После того как вы нажмете кнопку **Настроить веб-службу**, начинается преобразование обучающего эксперимента в прогнозный эксперимент. В большинстве случаев этого достаточно. Но если вы работаете над сложным обучающим экспериментом (например, имеется несколько объединяющихся путей для обучения), возможно, стоит преобразовать его вручную. Дополнительные сведения о выполнении этого преобразования см. в статье [Преобразование обучающего эксперимента машинного обучения в прогностический эксперимент](machine-learning-convert-training-experiment-to-scoring-experiment.md).

### Веб-служба

Убедившись в готовности прогнозного эксперимента, можно развернуть службу как классическую или как новую веб-службу, основанную на Azure Resource Manager. Чтобы развернуть модель как *классическую веб-службу*, щелкните **Deploy Web Service** (Развернуть веб-службу) и выберите **Deploy Web Service [Classic]** (Развернуть веб-службу [классическую]). Чтобы развернуть модель *как новую веб-службу*, щелкните **Deploy Web Service** (Развернуть веб-службу) и выберите **Deploy Web Service [New]** (Развернуть веб-службу [новую]). Пользователи теперь могут отправлять данные в вашу модель с помощью REST API веб-службы и получать результаты. Дополнительные сведения о том, как это сделать, см. в статье[Как использовать веб-службу машинного обучения Azure, развернутую из эксперимента машинного обучения](machine-learning-consume-web-services.md).

После развертывания веб-службы прогнозный эксперимент и веб-служба остаются подключенными, и вы можете переключаться между ними, как описано ниже.

| ***На этой странице...*** | ***щелкните этот элемент…*** | ***чтобы открыть эту страницу…*** |
| ------------------- | --------------- | ---------------------- |
|холст эксперимента в студии|**Перейти к веб-службе**|конфигурация веб-службы в студии|
|конфигурация веб-службы в студии|**Просмотр последних**|холст эксперимента в студии|
|конфигурация веб-службы в студии (только для классической веб-службы)|**Управление конечными точками...**|управление конечными точками на классическом портале Azure|
|управление конечными точками на классическом портале Azure (только для классической веб-службы)|**Редактировать в студии**|холст эксперимента в студии|

![](media\machine-learning-model-progression-experiment-to-web-service\connections-between-experiment-and-web-service.png)

*Рис. 2. Связи между экспериментом и веб-службой*

## Нетипичный случай: создание непрогнозной веб-службы

Если в вашем эксперименте не выполняется обучение модели прогнозного анализа, то вам не нужно создавать ни обучающий, ни оценивающий эксперимент. Для этого существует только один эксперимент, и его можно развернуть как веб-службу. Анализируя использованные модули, студия машинного обучения определяет, содержит ли ваш эксперимент прогнозную модель.

Выполнив итерацию с экспериментом и проверив его готовность, выполните такие действия.

1.  Нажмите кнопку **Настроить веб-службу** — входные и выходные узлы будут добавлены автоматически.

2.  Выберите команду **Выполнить**.

3. Щелкните **Deploy Web Service** (Развернуть веб-службу) и выберите **Deploy Web Service [Classic]** (Развернуть веб-службу [классическую]) или **Deploy Web Service [New]** (Развернуть веб-службу [новую]), в зависимости от среды, в которой будет выполняться развертывание.

Теперь ваша веб-служба развернута, к ней можно получить доступ и управлять ею так же, как прогнозной веб-службой.

## Кнопки веб-службы

В студии машинного обучения название и функции кнопок веб-службы **Настроить веб-службу** и **Развернуть веб-службу** изменяются в зависимости от того, на каком этапе разработки вы находитесь.

**Эксперимент содержит прогнозную модель**

Если в ходе эксперимента осуществляется обучение и оценка прогнозной модели, то кнопки веб-службы выполняют функции, описанные в таблице.

|**Тип эксперимента**|**Кнопка**|**Назначение**|
| -------------------- | -------- | -------------- |
|Эксперимент в разработке|**Настроить веб-службу**|Предоставляет два варианта|
|&nbsp;|- **Прогнозная веб-служба**|Преобразует эксперимент и в обучающий, и в оценивающий.|
|&nbsp;|- **Переобучение веб-службы**|Преобразует эксперимент в переобучающий эксперимент (см. раздел «Обновление» ниже)|
|Эксперимент по обучению|**Настроить веб-службу**|Предоставляет два варианта|
|&nbsp;|— **Обновить прогнозный эксперимент**|Вносит в связанный прогнозный эксперимент изменения, внесенные в обучающий эксперимент|
|&nbsp;|- **Переобучение веб-службы**|Преобразует обучающий эксперимент в переобучающий (см. раздел «Обновление» ниже)|
|&nbsp;|— *или* — **Deploy Web Service [Classic]** (Развернуть веб-службу [классическую]) |Если вы настроили для развертывания переобучающий эксперимент, то эта команда разворачивает его как классическую веб-службу|
|&nbsp;|— *или* — **Deploy Web Service [New]** (Развернуть веб-службу [новую]) |Если вы настроили для развертывания переобучающий эксперимент, то эта команда разворачивает его как новую веб-службу|
|Прогнозный эксперимент|**Deploy Web Service [Classic]** (Развернуть веб-службу [классическую]) |Развертывание прогнозного эксперимента в качестве классической веб-службы|
|Прогнозный эксперимент|**Deploy Web Service [New]** (Развернуть веб-службу [новую]) |Развертывание прогнозного эксперимента в качестве новой веб-службы|

**Эксперимент *не* содержит прогнозную модель**

Если в ходе эксперимента не осуществляется обучение и оценка прогнозной модели, то кнопки выглядят гораздо проще.

|**Тип эксперимента**|**Кнопка**|**Назначение**|
| -------------------- | -------- | -------------- |
|Эксперимент в разработке|**Настроить веб-службу**|Подготавливает эксперимент для развертывания в качестве веб-службы|
|Готовый к развертыванию эксперимент|***Deploy Web Service [Classic]** (Развернуть веб-службу [классическую])|Развертывает эксперимент как веб-службу, открывает страницу настройки классической веб-службы|
|&nbsp;|— *или* — **Deploy Web Service [New]** (Развернуть веб-службу [новую])| Развертывание в качестве новой веб-службы|

## Обновление веб-службы

Как обновить эксперимент, развернутый в качестве веб-службы?

Это зависит от того, что именно необходимо обновить.

**Необходимо изменить входные или выходные данные или изменить способ обработки данных веб-службой**

Если изменяется не модель, а только способ обработки данных веб-службой, то можно изменить прогнозный эксперимент, а затем еще раз нажать кнопку **Deploy Web Service** (Развернуть веб-службу) и выбрать **Deploy Web Service [Classic]** (Развернуть веб-службу [классическую]) или **Deploy Web Service [New]** (Развернуть веб-службу [новую]). Веб-служба будет остановлена, обновленный прогнозный эксперимент будет развернут, а затем снова будет запущена веб-служба.

Рассмотрим такой пример: предположим, что прогнозный эксперимент возвращает всю строку входных данных с прогнозируемым результатом. Вы можете решить, что веб-служба должна возвращать только результат. Для этого в прогнозном эксперименте непосредственно перед портом вывода можно добавить модуль **Столбцы проекта**, чтобы исключить все столбцы, кроме результата. Если еще раз щелкнуть **Deploy Web Service** (Развернуть веб-службу) и выбрать **Deploy Web Service [Classic]** (Развернуть веб-службу [классическую]) или **Deploy Web Service [New]** (Развернуть веб-службу [новую]), то веб-служба обновится.

**Необходимо выполнить переобучение модели с использованием новых данных**

Если вы хотите сохранить модель машинного обучения и переобучить ее с использованием новых данных, для этого есть два варианта.

1.  **Переобучение модели во время работы веб-службы.** Если нужно выполнить переобучение модели во время работы прогнозной веб-службы, для этого можно внести несколько изменений в обучающий эксперимент и преобразовать его в ***переобучающий эксперимент***, а затем развернуть его в качестве ***веб-службы* переобучения**. Дополнительные сведения об этом действии см. в статье [Программное переобучение моделей машинного обучения](machine-learning-retrain-models-programmatically.md).

2.  **Возврат к исходному обучающему эксперименту и использование для разработки модели другого набора данных для обучения.** Прогнозный эксперимент связан с веб-службой, но обучающий эксперимент не имеет такой непосредственной связи. Если изменить исходный обучающий эксперимент и нажать кнопку **Настроить веб-службу**, то будет создан *новый* прогнозный эксперимент, который после развертывания создаст *новую* веб-службу. Это действие не обновляет исходную веб-службу.

    Поэтому, если требуется изменить обучающий эксперимент, откройте его и выберите команду **Сохранить как**, чтобы сделать его копию. Это оставит исходный обучающий эксперимент, прогнозный эксперимент и веб-службу без изменений. Теперь вы можете создать новую веб-службу с использованием изменений. После развертывания новой веб-службы можно остановить предыдущую веб-службу или оставить ее для работы наряду с новой.

**Необходимо обучить другую модель**

Если требуется внести изменения в исходный прогнозный эксперимент, например выбрать другой алгоритм машинного обучения, попробовать другой метод обучения и т. д., то вам необходимо выполнить вторую процедуру, описанную выше, для переобучения модели. Откройте обучающий эксперимент, выберите команду **Сохранить как**, чтобы создать копию, а затем выполните последовательность действий для разработки модели, создания прогнозного эксперимента и развертывания веб-службы. В результате у вас будет новая веб-служба, не связанная с исходной. Можно выбрать, какая из них будет выполняться (или же оставить в работе обе).

## Дополнительные материалы

Дополнительные сведения об этом процессе см. в следующих статьях.

-   Преобразование эксперимента: [преобразование обучающего эксперимента машинного обучения в прогностический эксперимент](machine-learning-convert-training-experiment-to-scoring-experiment.md).

-   Развертывание веб-службы: [развертывание веб-службы машинного обучения Azure](machine-learning-publish-a-machine-learning-web-service.md).

-   Переобучение модели: [программное переобучение моделей машинного обучения](machine-learning-retrain-models-programmatically.md).

Примеры всего процесса см. в этих статьях.

-   [Инструкции по созданию первого эксперимента в Студии машинного обучения Azure](machine-learning-create-experiment.md)

-   [Пошаговое руководство по разработке решения для прогнозной аналитики в службе машинного обучения Azure для оценки кредитных рисков](machine-learning-walkthrough-develop-predictive-solution.md)

<!---HONumber=AcomDC_0914_2016-->
