<properties
	pageTitle="Типы конечной точки версии 2.0 | Microsoft Azure"
	description="Типы приложений и сценарии, поддерживаемые конечной точкой Azure AD версии 2.0."
	services="active-directory"
	documentationCenter=""
	authors="dstrockis"
	manager="mbaldwin"
	editor=""/>

<tags
	ms.service="active-directory"
	ms.workload="identity"
	ms.tgt_pltfrm="na"
	ms.devlang="na"
	ms.topic="article"
	ms.date="09/16/2016"
	ms.author="dastrock"/>

# Типы конечной точки версии 2.0
Конечная точка версии 2.0 поддерживает проверку подлинности для различных архитектур современных приложений, которая основана на стандартных отраслевых протоколах [OAuth 2.0](active-directory-v2-protocols.md#oauth2-authorization-code-flow) и [OpenID Connect](active-directory-v2-protocols.md#openid-connect-sign-in-flow). В этом документе кратко описаны типы приложений, которые можно создавать независимо от используемого языка или платформы. Он поможет вам изучить базовые сценарии, прежде чем [перейти непосредственно к коду](active-directory-appmodel-v2-overview.md#getting-started).

> [AZURE.NOTE]
	Не все сценарии и компоненты Azure Active Directory поддерживаются конечной точкой версии 2.0. Чтобы определить, следует ли вам использовать конечную точку версии 2.0, ознакомьтесь с [ограничениями версии 2.0](active-directory-v2-limitations.md).

## Основные сведения
Каждое приложение, использующее конечную точку 2.0, необходимо зарегистрировать на сайте [apps.dev.microsoft.com](https://apps.dev.microsoft.com). В процессе регистрации для приложения будет собрано и назначено несколько значений:

- **Идентификатор приложения**, определяющий конкретное приложение.
- **Универсальный код ресурса (URI) перенаправления**, который можно использовать для направления ответов к приложению.
- Несколько других зависящих от сценария значений. Вы можете подробнее узнать о процедуре [регистрации приложения](active-directory-v2-app-registration.md).

После регистрации приложение взаимодействует с Azure AD, отправляя запросы к конечной точке Azure Active Directory версии 2.0. Мы предоставляем платформы и библиотеки с открытым исходным кодом, обрабатывающие сведения об этих запросах. Кроме того, вы можете реализовать собственную логику проверки подлинности путем составления запросов для этих конечных точек:

```
https://login.microsoftonline.com/common/oauth2/v2.0/authorize
https://login.microsoftonline.com/common/oauth2/v2.0/token
```
<!-- TODO: Need a page for libraries to link to -->

## веб-приложений:
Для веб-приложений (.NET, PHP, Java, Ruby, Python, Node и т. д.), доступных через браузер, поддерживается вход пользователей с помощью [OpenID Connect](active-directory-v2-protocols.md#openid-connect-sign-in-flow). В OpenID Connect веб-приложение получает `id_token`, токен безопасности, который проверяет удостоверение пользователя и предоставляет сведения о пользователе в форме утверждений:

```
// Partial raw id_token
eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6ImtyaU1QZG1Cd...

// Partial content of a decoded id_token
{
	"name": "John Smith",
	"email": "john.smith@gmail.com",
	"oid": "d9674823-dffc-4e3f-a6eb-62fe4bd48a58"
	...
}
```

Все типы маркеров и утверждений, доступных для приложения, описаны в [справочнике по маркерам версии 2.0](active-directory-v2-tokens.md).

В приложениях веб-сервера поток проверки подлинности для входа состоит из следующих базовых этапов:

![Изображение веб-приложения Swimlanes](../media/active-directory-v2-flows/convergence_scenarios_webapp.png)

Проверки маркера идентификатора с помощью открытого ключа подписи, полученного от конечной точки версии 2.0, достаточно для проверки удостоверения пользователя, а также задания файла cookie сеанса, который может использоваться для идентификации пользователя в последующих запросах страницы.

Чтобы увидеть этот сценарий в действии, изучите один из примеров кода входа веб-приложения из раздела [Приступая к работе](active-directory-appmodel-v2-overview.md#getting-started).

Помимо простого входа в систему, приложению веб-сервера может потребоваться доступ к некоторым другим веб-службам, например интерфейсу API REST. В этом случае приложение веб-сервера может быть задействовано в объединенном потоке OpenID Connect и OAuth 2.0 с использованием [потока кода авторизации OAuth 2.0](active-directory-v2-protocols.md#oauth2-authorization-code-flow). Этот сценарий описан далее в разделе о [начале работы с веб-API и веб-приложениями](active-directory-v2-devquickstarts-webapp-webapi-dotnet.md).

## Веб-API
Конечную точку версии 2.0 также можно использовать для защиты веб-служб, таких как веб-API с поддержкой REST. Интерфейсы веб-API вместо маркеров идентификатора и файлов cookie сеанса используют маркеры доступа OAuth 2.0 для защиты данных и проверки подлинности входящих запросов. Объект, вызывающий веб-API, добавляет маркер доступа в начале заголовка авторизации HTTP-запроса:

```
GET /api/items HTTP/1.1
Host: www.mywebapi.com
Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6...
Accept: application/json
...
```

Веб-API может использовать маркер доступа для проверки удостоверения объекта, вызывающего API, и получения сведений о нем из утверждений, которые закодированы в маркере доступа. Все типы маркеров и утверждений, доступных для приложения, описаны в [справочнике по маркерам версии 2.0](active-directory-v2-tokens.md).

Веб-API может дать пользователям возможность использовать определенные функции и данные или отказаться от них, предоставляя разрешения, которые также называют [областями](active-directory-v2-scopes.md). Чтобы вызывающее приложение получило разрешение для области, пользователь должен дать согласие на это. Конечная точка версии 2.0 запросит разрешения у пользователя и запишет их во все маркеры доступа, получаемые веб-API. Все, что нужно выполнять веб-API — проверять маркеры доступа, принимаемых при каждом вызове, и выполнять соответствующие проверки авторизации.

Веб-API может получать маркеры доступа от всех типов приложений, включая приложения веб-сервера, классические и мобильные приложения, одностраничные приложения, серверные управляющие программы и даже другие веб-API. Поток верхнего уровня для проверки подлинности веб-API выглядит следующим образом:

![Изображение дорожек веб-API](../media/active-directory-v2-flows/convergence_scenarios_webapi.png)

Дополнительные сведения о кодах авторизации, маркерах обновления, а также подробные инструкции о получении маркеров доступа см. в описании [протокола OAuth 2.0](active-directory-v2-protocols-oauth-code.md).

Чтобы узнать, как защитить веб-API с помощью маркеров доступа OAuth 2.0, изучите примеры кода веб-API в разделе [Приступая к работе](active-directory-appmodel-v2-overview.md#getting-started).


## Мобильные и собственные приложения
Приложениям, установленным на устройстве, например мобильным и классическим приложениям, часто требуется доступ к внутренним службам или веб-API, которые хранят данные и выполняют различные функции от имени пользователя. В этих приложениях можно реализовать процесс входа и авторизации в серверных службах с помощью [потока кода авторизации OAuth 2.0](active-directory-v2-protocols-oauth-code.md).

В этом потоке приложение получает код авторизации от конечной точки версии 2.0 при входе пользователя. Такой код представляет собой разрешение приложения на вызов серверных служб от имени выполнившего вход пользователя. Приложение может передать код авторизации в фоновом режиме, чтобы получить маркер доступа OAuth 2.0 и маркер обновления. Приложение может использовать маркер доступа для проверки подлинности в веб-API в HTTP-запросах и использовать маркер обновления, чтобы получить новые маркеры доступа после истечения срока действия старых маркеров.

![Изображение собственного приложения Swimlanes](../media/active-directory-v2-flows/convergence_scenarios_native.png)

## Одностраничные приложения (Javascript)
Многие современные приложения применяют одностраничный интерфейсный модуль (SPA), написанный в основном на Javascript и часто использующий такие платформы, как AngularJS, Ember.js, Durandal и т. д. Конечная точка Azure AD версии 2.0 поддерживает эти приложения с помощью [неявного потока OAuth 2.0](active-directory-v2-protocols-implicit.md).

В этом потоке приложение получает маркеры из конечной точки авторизации версии 2.0 напрямую без обмена данными между внутренним и другим сервером. Это позволяет разместить всю логику проверки подлинности и обработки сеансов в клиенте Javascript без дополнительных перенаправлений страниц.

![Изображение дорожек неявного потока](../media/active-directory-v2-flows/convergence_scenarios_implicit.png)

Чтобы увидеть этот сценарий в действии, изучите один из примеров кода одностраничного приложения из раздела [Приступая к работе](active-directory-appmodel-v2-overview.md#getting-started).

## Текущие ограничения
Эти типы приложений в настоящее время не поддерживаются конечной точкой версии 2.0, однако добавление такой поддержки планируется. Другие ограничения конечной точки Azure AD версии 2.0 описаны в [этой статье](active-directory-v2-limitations.md).

### Управляющие программы и серверные приложения
Приложениям, содержащим долговременные процессы или работающим без пользователя, также нужна возможность доступа к защищенным ресурсам, таким как веб-API. Такие приложения могут проверять подлинность и получать маркеры, используя удостоверение приложения (а не удостоверение делегированного пользователя) с помощью потока учетных данных клиента OAuth 2.0.

Поток учетных данных клиента в настоящее время не поддерживается в конечной точке версии 2.0. Чтобы ознакомиться с принципами работы этого потока в общедоступной службе Azure AD, изучите [пример кода управляющей программы на GitHub](https://github.com/AzureADSamples/Daemon-DotNet).

### Связанные веб-API
Многие архитектуры включают в себя веб-API, которым требуется вызывать другие подчиненные веб-API. При этом оба интерфейса защищены конечной точкой версии 2.0. Этот сценарий характерен для собственных клиентов с внутренним веб-API, который в свою очередь вызывает службу Microsoft Online, например Office 365 или API Graph.

Сценарий связанных веб-API может поддерживаться с помощью предоставления учетных данных носителя маркера JWT OAuth 2.0 или [потока "On-Behalf-Of"](active-directory-v2-protocols.md#oauth2-on-behalf-of-flow). Однако поток "On-Behalf-Of" еще не реализован в конечной точке версии 2.0. Чтобы увидеть его в общедоступной службе Azure AD, изучите [пример кода "On-Behalf-Of" на GitHub](https://github.com/AzureADSamples/WebAPI-OnBehalfOf-DotNet).

<!---HONumber=AcomDC_0921_2016-->