<properties
	pageTitle="Устранение неполадок: управление паролями Azure AD| Microsoft Azure"
	description="Общие рекомендации по устранению неполадок компонентов управления паролями Azure AD, включая сброс, изменение, обратную запись, регистрацию и сведения, включаемые при поиске справки."
	services="active-directory"
	documentationCenter=""
	authors="asteen"
	manager="femila"
	editor="curtand"/>

<tags
	ms.service="active-directory"
	ms.workload="identity"
	ms.tgt_pltfrm="na"
	ms.devlang="na"
	ms.topic="article"
	ms.date="08/12/2016"
	ms.author="asteen"/>

# Устранение неполадок, связанных с управлением паролями

> [AZURE.IMPORTANT] **Вы здесь потому, что возникают проблемы при входе?** Если это так, [с помощью этих инструкций можно изменить и сбросить пароль](active-directory-passwords-update-your-own-password.md).

Если возникают проблемы с управлением паролями, мы готовы помочь. Большинство возникающих проблем можно решить несколькими простыми шагами по устранению неполадок развернутой системы, которые описаны ниже.

* [**Сведения, которые необходимо указать, если требуется помощь**](#information-to-include-when-you-need-help)
* [**Проблемы с конфигурацией управления паролями на портале управления Azure**](#troubleshoot-password-reset-configuration-in-the-azure-management-portal)
* [**Проблемы с отчетами об управлении паролями на портале управления Azure**](#troubleshoot-password-management-reports-in-the-azure-management-portal)
* [**Проблемы с порталом регистрации сброса паролей**](#troubleshoot-the-password-reset-registration-portal)
* [**Проблемы с порталом сброса паролей**](#troubleshoot-the-password-reset-portal)
* [**Проблемы с обратной записью паролей**](#troubleshoot-password-writeback)
  - [Коды ошибок журнала событий обратной записи паролей](#password-writeback-event-log-error-codes)
  - [Проблемы с подключением обратной записи паролей](#troubleshoot-password-writeback-connectivity)

Если вы уже пробовали выполнить действия по устранению неполадок и они по-прежнему сохраняются, вы можете разместить вопрос на [форумах Azure AD](https://social.msdn.microsoft.com/forums/azure/home?forum=WindowsAzureAD) или обратиться в службу поддержки. Мы рассмотрим вашу проблему как можно быстрее.

## Сведения, которые необходимо указать, если требуется помощь

Если не удается решить проблему с помощью приведенных ниже инструкций, можно обратиться к инженерам нашей службы поддержки. При обращении к ним рекомендуется указать следующие сведения.

 - **Общее описание ошибки** — какое в точности сообщение об ошибке увидел пользователь? Если сообщения об ошибке не было, подробно опишите непредвиденное поведение, которое вы заметили.
 - **Страница** — на какой странице вы находились, когда увидели ошибку (включая URL-адрес)?
 - **Дата/время/часовой пояс** — точные дата и время, когда вы заметили ошибку (включая часовой пояс)?
 - **Код поддержки** — какой код поддержки был сформирован, когда пользователь увидел ошибку (чтобы найти его, воспроизведите ошибку, затем щелкните ссылку «Код поддержки» внизу экрана и отправьте специалисту службы поддержки идентификатор GUID, который отобразится в результате).
   - Если вы находитесь на странице, внизу которой отсутствует код поддержки, нажмите клавишу F12 и поищите SID и CID, после чего отправьте два найденных результата специалисту службы поддержки.

    ![][001]

 - **Идентификатор пользователя** — идентификатор пользователя, который увидел ошибку (например, user@contoso.com)?
 - **Сведения о пользователе** — был ли пользователь федеративным, с включенной синхронизацией хэшей паролей, или только облачным? Была ли назначена пользователю лицензия AAD Premium или AAD Basic?
 - **Журнал событий приложений** — если используется обратная запись паролей и код ошибки находится в вашей локальной инфраструктуре, отправьте нам архив с копией журнала событий приложений с сервера Azure AD Connect и отправьте его вместе с вашим запросом.

Добавление этих сведений поможет нам устранить неполадку как можно быстрее.


## Устранение неполадок в конфигурации сброса пароля на портале управления Azure
Если возникает ошибка при настройке сброса пароля, вы можете устранить ее следующим образом.

<table>
          <tbody><tr>
            <td>
              <p>
                <strong>Ситуация ошибки</strong>
              </p>
            </td>
            <td>
              <p>
                <strong>Какую ошибку видит пользователь?</strong>
              </p>
            </td>
            <td>
              <p>
                <strong>Решение</strong>
              </p>
            </td>
          </tr>
          <tr>
            <td>
              <p>Я не вижу раздела <strong>Политика сброса пароля пользователя</strong> на вкладке <strong>Настройка</strong> на портале управления Azure</p>
            </td>
            <td>
              <p>Раздел <strong>Политика сброса пароля пользователя</strong> не виден на вкладке <strong>Настройка</strong> на портале управления Azure</p>
            </td>
            <td>
              <p>Это может произойти, если администратору, выполняющему данную операцию, не назначена лицензия AAD Premium или AAD Basic. </p>
              <p>Чтобы исправить это, назначьте лицензию AAD Premium или AAD Basic соответствующей учетной записи администратора, перейдя на вкладку <strong>Лицензии</strong> и повторив попытку.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>В разделе <strong>Политика сброса пароля пользователя</strong> я не вижу никаких параметров конфигурации, которые описаны в документации.</p>
            </td>
            <td>
              <p>Раздел <strong>Политика сброса пароля пользователя</strong> отображается, но в нем есть только флаг <strong>Пользователям разрешен сброс пароля</strong>.</p>
            </td>
            <td>
              <p>Остальная часть пользовательского интерфейса будет отображаться при установке для флага <strong>Пользователям разрешен сброс пароля</strong> значения <strong>Да</strong>.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>Я не конкретного параметра конфигурации.</p>
            </td>
            <td>
              <p>Например, я не вижу параметра <strong>Число дней до того, как пользователь должен подтвердить свои контактные данные</strong> при прокрутке через раздел <strong>Политика сброса пароля пользователя</strong> (или другие примеры той же проблемы).</p>
            </td>
            <td>
              <p>Многие элементы пользовательского интерфейса скрыты до тех пор, пока они не понадобятся. Попробуйте включить все параметры на странице, если требуется просмотреть их все.</p>
              <p>Дополнительные сведения обо всех элементах управления, которые для вас доступны, см. в разделе <a href="active-directory-passwords-customize.md#password-management-behavior">Поведение службы управления паролями</a>.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>Я не вижу параметра конфигурации <strong>Обратная запись паролей в локальный каталог</strong></p>
            </td>
            <td>
              <p>Параметр <strong>Обратная запись паролей в локальный каталог</strong> не виден на вкладке <strong>Настройка</strong> на портале управления Azure</p>
            </td>
            <td>
              <p>Этот параметр отображается, только если загружено средство Azure AD Connect и настроена обратная запись паролей. После того как это будет сделано, данный параметр появится и позволит включить или отключить обратную запись из облака.</p>
              <p>Дополнительные сведения о том, как это сделать, см. в разделе <a href="active-directory-passwords-getting-started.md#step-2-enable-password-writeback-in-azure-ad-connect">Включение обратной записи паролей в Azure AD Connect</a>.</p>
            </td>
          </tr>
        </tbody></table>

## Устранение неполадок с отчетами об управлении паролями на портале управления Azure
Если возникает ошибка при использовании отчетов об управлении паролями, возможно, устранить ее помогут следующие действия:

<table>
          <tbody><tr>
            <td>
              <p>
                <strong>Ситуация ошибки</strong>
              </p>
            </td>
            <td>
              <p>
                <strong>Какую ошибку видит пользователь?</strong>
              </p>
            </td>
            <td>
              <p>
                <strong>Решение</strong>
              </p>
            </td>
          </tr>
          <tr>
            <td>
              <p>Я не вижу никаких отчетов об управлении паролями</p>
            </td>
            <td>
              <p>Отчеты <strong>Действие сброса пароля</strong> и <strong>Действие регистрации сброса пароля</strong> не отображаются в списке <strong>Журнал действий</strong> на вкладке <strong>Отчеты</strong>.</p>
            </td>
            <td>
              <p>Это может произойти, если администратору, выполняющему данную операцию, не назначена лицензия AAD Premium или AAD Basic. </p>
              <p>Чтобы исправить это, назначьте лицензию AAD Premium или AAD Basic соответствующей учетной записи администратора, перейдя на вкладку <strong>Лицензии</strong> и повторив попытку.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>Регистрации пользователя отображаются несколько раз</p>
            </td>
            <td>
              <p>Когда пользователь регистрирует запасной адрес электронной почты, мобильный телефон и секретные вопросы, все эти параметры отображаются в отдельных строках вместо одной строки.</p>
            </td>
            <td>
              <p>В настоящее время при регистрации пользователя мы не можем предполагать, что он зарегистрирует все элементы на странице регистрации. В результате мы записываем каждый зарегистрированный фрагмент данных в журнал как отдельное событие.</p>
              <p>Если необходимо агрегировать эти данные, можно загрузить отчет и открыть данные в виде сводной таблицы в Excel для обеспечения большей гибкости.</p>
            </td>
          </tr>
        </tbody></table>

## Устранение неполадок с порталом регистрации сброса паролей
Если возникает ошибка при регистрации пользователя для сброса пароля, вы можете устранить ее следующим образом.

<table>
          <tbody><tr>
            <td>
              <p>
                <strong>Ситуация ошибки</strong>
              </p>
            </td>
            <td>
              <p>
                <strong>Какую ошибку видит пользователь?</strong>
              </p>
            </td>
            <td>
              <p>
                <strong>Решение</strong>
              </p>
            </td>
          </tr>
          <tr>
            <td>
              <p>Для каталога запрещен сброс пароля</p>
            </td>
            <td>
              <p>Администратор не включил для вас возможность использовать эту функцию.</p>
            </td>
            <td>
              <p>Переключите флаг <strong>Пользователям разрешен сброс пароля</strong> на значение <strong>Да</strong> и нажмите кнопку <strong>Сохранить</strong> на вкладке настройки каталога портала управления Azure. Администратору, выполняющему данную операцию, должна быть назначена лицензия Azure AD Premium или Basic.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>Пользователю не назначена лицензия AAD Premium или AAD Basic</p>
            </td>
            <td>
              <p>Администратор не включил для вас возможность использовать эту функцию.</p>
            </td>
            <td>
              <p>Назначьте пользователю лицензию Azure AD Premium или Azure AD Basic на вкладке <strong>Лицензии</strong> на портале управления Azure. Администратору, выполняющему данную операцию, должна быть назначена лицензия Azure AD Premium или Basic.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>Ошибка при обработке запроса</p>
            </td>
            <td>
              <p>Пользователь видит сообщение об ошибке:</p>
              <p>

              </p>
              <p>Ошибка при обработке запроса </p>
              <p>При попытке выполнить сброс пароля.</p>
            </td>
            <td>
              <p>Это может быть вызвано многими проблемами, но обычно такая ошибка вызывается либо отказом службы, либо проблемой конфигурации, которую невозможно разрешить. </p>
              <p>Если эта ошибка влияет на деятельность организации, обратитесь в службу поддержки, и мы поможем в кратчайшие сроки. См. раздел <a href="#information-to-include-when-you-need-help">Сведения, которые необходимо указать, если требуется помощь</a> для просмотра информации, которую вам следует предоставить специалисту службы поддержки для помощи в быстром разрешении проблемы.</p>
            </td>
          </tr>
        </tbody></table>

## Устранение неполадок с порталом сброса паролей
Если возникает ошибка при сбросе пароля пользователя, возможно, устранить ее помогут следующие действия.

<table>
          <tbody><tr>
            <td>
              <p>
                <strong>Ситуация ошибки</strong>
              </p>
            </td>
            <td>
              <p>
                <strong>Какую ошибку видит пользователь?</strong>
              </p>
            </td>
            <td>
              <p>
                <strong>Решение</strong>
              </p>
            </td>
          </tr>
          <tr>
            <td>
              <p>Для каталога запрещен сброс пароля</p>
            </td>
            <td>
              <p>Для вашей учетной записи запрещен сброс пароля</p>
              <p>К сожалению, администратор не установил для вашей учетной записи возможность использовать эту службу. </p>
              <p>

              </p>
              <p>Если хотите, мы можем обратиться к администратору вашей организации для сброса вашего пароля.</p>
            </td>
            <td>
              <p>Переключите флаг <strong>Пользователям разрешен сброс пароля</strong> на значение <strong>Да</strong> и нажмите кнопку <strong>Сохранить</strong> на вкладке настройки каталога портала управления Azure. Администратору, выполняющему данную операцию, должна быть назначена лицензия Azure AD Premium или Basic.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>Пользователю не назначена лицензия AAD Premium или AAD Basic</p>
            </td>
            <td>
              <p>Хотя автоматически мы не можем сбрасывать пароли учетных записей без прав администратора, мы можем обратиться к администратору вашей организации, чтобы он сделал это для вас.</p>
            </td>
            <td>
              <p>Назначьте пользователю лицензию Azure AD Premium или Azure AD Basic на вкладке <strong>Лицензии</strong> на портале управления Azure. Администратору, выполняющему данную операцию, должна быть назначена лицензия Azure AD Premium или Basic.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>Для каталога включен сброс паролей, но у пользователя отсутствуют или неправильно указаны сведения для проверки подлинности</p>
            </td>
            <td>
              <p>Для вашей учетной записи запрещен сброс пароля</p>
              <p>К сожалению, администратор не установил для вашей учетной записи возможность использовать эту службу. </p>
              <p>

              </p>
              <p>Если хотите, мы можем обратиться к администратору вашей организации для сброса вашего пароля.</p>
            </td>
            <td>
              <p>Убедитесь, что пользователь должным образом заполнил контактные данные при регистрации в каталоге, прежде чем продолжить. См. раздел <a href="active-directory-passwords-learn-more.md#what-data-is-used-by-password-reset">Какие данные используются при сбросе пароля</a>. Из него вы узнаете, как настроить информацию для проверки подлинности в каталоге таким образом, чтобы пользователям не отображалась эта ошибка.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>Для каталога включен сброс паролей, но пользователь указал при регистрации только один элемент контактных данных, в то время как настройка политики требует два этапа проверки</p>
            </td>
            <td>
              <p>Для вашей учетной записи запрещен сброс пароля</p>
              <p>К сожалению, администратор не установил для вашей учетной записи возможность использовать эту службу. </p>
              <p>

              </p>
              <p>Если хотите, мы можем обратиться к администратору вашей организации для сброса вашего пароля.</p>
            </td>
            <td>
              <p>Перед продолжением убедитесь, что у этого пользователя правильно настроены по крайней мере два способа связи (например, мобильный телефон и рабочий телефон). См. раздел <a href="active-directory-passwords-learn-more.md#what-data-is-used-by-password-reset">Какие данные используются при сбросе пароля</a>. Из него вы узнаете, как настроить информацию для проверки подлинности в каталоге таким образом, чтобы пользователям не отображалась эта ошибка.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>Для каталога включен сброс паролей и пользователь настроен правильно, но с пользователем не удается связаться </p>
            </td>
            <td>
              <p>Проблема! При попытке связаться с вами обнаружена непредвиденная ошибка.</p>
            </td>
            <td>
              <p>Она может быть результатом временной ошибки службы или неверно настроенных контактных данных, которые нам не удалось выявить. Если пользователь подождет 10 секунд и повторит попытку, появится ссылка «обратитесь к администратору». Если выбрать повтор попытки, выполняется повторная отправка вызова. При этом после выбора ссылки «обратитесь к администратору» пользователю будет отправлено электронное письмо с формой и пароль или будет отправлен запрос глобальным администраторам (в порядке очередности) сбросить пароль для соответствующей учетной записи пользователя.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>Пользователь не получает SMS или телефонного вызова для сброса пароля</p>
            </td>
            <td>
              <p>Пользователь нажимает кнопку отправки самому себе текстового сообщения или телефонного вызова и после этого ничего не получает</p>
            </td>
            <td>
              <p>Это может быть результатом неправильно указанного в каталоге телефонного номера. Убедитесь, что номер телефона указан в формате “+ccc xxxyyyzzzzXeeee”. Дополнительные сведения о форматировании телефонных номеров для использования при сбросе пароля см. в разделе <a href="active-directory-passwords-learn-more.md#what-data-is-used-by-password-reset">Какие данные используются при сбросе пароля</a>.</p>
              <p>Если данному пользователю требуется направить расширение номера, обратите внимание, что функция сброса пароля не поддерживает расширения, даже если указать его в каталоге (они удаляются перед отправкой вызова). Попробуйте использовать номер без расширения, или интегрировать расширение в номер телефона на вашей УАТС.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>Пользователь не получает сообщения электронной почты для сброса пароля</p>
            </td>
            <td>
              <p>Пользователь нажимает кнопку отправки самому себе электронного письма и после этого ничего не получает.</p>
            </td>
            <td>
              <p>Наиболее распространенной причиной этой проблемы является отклонение сообщения фильтром нежелательной почты. Проверьте папку спама, нежелательной почты или удаленных писем в своем почтовом ящике.</p>
              <p>Также убедитесь, что вы проверяете правильный почтовый ящик. У многих людей адреса электронной почты очень похожи, и может оказаться, что они проверяют неверный почтовый ящик. Если ни одно из этих решений не сработало, возможно, адрес электронной почты в каталоге имеет неправильный формат. Убедитесь, что адрес указан правильно, и повторите попытку. Дополнительные сведения о форматировании адресов электронной почты для использования при сбросе пароля см. в разделе <a href="active-directory-passwords-learn-more.md#what-data-is-used-by-password-reset">Какие данные используются при сбросе пароля</a>.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>Мною установлена политика сброса паролей, но когда учетная запись администратора использует сброс пароля, эта политика не применяется</p>
            </td>
            <td>
              <p>Для учетных записей администраторов, сбрасывающих пароли, отображаются те же включенные параметры сброса пароля, электронной почты и мобильного телефона, независимо от того, какая политика задана в разделе <strong>Политика сброса пароля пользователя</strong> на вкладке <strong>Настройка</strong>.</p>
            </td>
            <td>
              <p>Параметры, настроенные в разделе <strong>Политика сброса пароля пользователя</strong> на вкладке <strong>Настройка</strong>, применяются только к конечным пользователям в вашей организации.</p>
              <p>Корпорация Майкрософт осуществляет управление и контроль политики сброса паролей администраторов для обеспечения максимально высокого уровня безопасности.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>Пользователь предпринял слишком много попыток сброса пароля в день, и для него эта возможность была заблокирована</p>
            </td>
            <td>
              <p>Пользователь видит сообщение об ошибке:</p>
              <p>

              </p>
              <p>Используйте другой вариант.</p>
              <p>Вы попытались пройти проверку учетной записи слишком много раз за последний час. По соображениям безопасности необходимо подождать 24 часа, прежде чем вы сможете повторить попытку. </p>
              <p>Если хотите, мы можем обратиться к администратору вашей организации для сброса вашего пароля.</p>
            </td>
            <td>
              <p>Мы реализуем механизм автоматического регулирования для блокировки слишком большого числа попыток сброса пароля пользователями за короткий период времени. Это происходит в следующих случаях.</p>
              <ol class="ordered">
                <li>
										Пользователь пытается проверить номер телефона 5 раз за один час.<br\><br\></li>
                <li>
										Пользователь пытается использовать шлюз вопросов безопасности 5 раз за один час.<br\><br\></li>
                <li>
										Пользователь пытается сбросить пароль для одной и той же учетной записи 5 раз за один час.<br\><br\></li>
              </ol>
              <p>Чтобы устранить эту проблему, попросите пользователя подождать 24 часа с момента последней попытки, после чего он сможет сбросить свой пароль.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>Пользователь видит ошибку при проверке своего номера телефона</p>
            </td>
            <td>
              <p>При попытке проверить телефон для использования в качестве метода проверки подлинности пользователь видит ошибку с сообщением:</p>
              <p>

              </p>
              <p>Указан неправильный номер телефона.</p>
            </td>
            <td>
              <p>Эта ошибка возникает, если введенный номер телефона не совпадает с номером, который был зарегистрирован.</p>
              <p>Убедитесь, что при попытке сбросить пароль с помощью телефона пользователь вводит номер телефона полностью, включая код региона и страны.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>Ошибка при обработке запроса</p>
            </td>
            <td>
              <p>Пользователь видит сообщение об ошибке:</p>
              <p>

              </p>
              <p>Ошибка при обработке запроса </p>
              <p>При попытке выполнить сброс пароля.</p>
            </td>
            <td>
              <p>Это может быть вызвано многими проблемами, но обычно такая ошибка вызывается либо отказом службы, либо проблемой конфигурации, которую невозможно разрешить. </p>
              <p>Если эта ошибка влияет на деятельность организации, обратитесь в службу поддержки, и мы поможем в кратчайшие сроки. См. раздел <a href="#information-to-include-when-you-need-help">Сведения, которые необходимо указать, если требуется помощь</a> для просмотра информации, которую вам следует предоставить специалисту службы поддержки для помощи в быстром разрешении проблемы.</p>
            </td>
          </tr>
        </tbody></table>

## Устранение неполадок с обратной записью паролей
Если возникает ошибка при включении, отключении или использовании обратной записи паролей, вы можете устранить ее следующим образом.

<table>
          <tbody><tr>
            <td>
              <p>
                <strong>Ситуация ошибки</strong>
              </p>
            </td>
            <td>
              <p>
                <strong>Какую ошибку видит пользователь?</strong>
              </p>
            </td>
            <td>
              <p>
                <strong>Решение</strong>
              </p>
            </td>
          </tr>
          <tr>
            <td>
              <p>Общие сбои адаптации и запуска</p>
            </td>
            <td>
              <p>Служба сброса пароля не запускается на локальном компьютере с записью ошибки 6800 в журнале событий приложений на компьютере Azure AD Connect.</p>
              <p>

              </p>
              <p>После адаптации федеративные пользователи или пользователи с синхронизацией хэшей паролей не могут сбрасывать пароли.</p>
            </td>
            <td>
              <p>Если включена обратная запись паролей, обработчик синхронизации вызовет библиотеку обратной записи для выполнения настройки (адаптации) путем обращения к облачной службе адаптации. Все ошибки, обнаруженные во время адаптации или при запуске конечной точки WCF для обратной записи паролей, приведут к ошибкам в журнале событий компьютера Azure AD Connect.</p>
              <p>При перезапуске службы ADSync, если была настроена обратная запись, будет запущена конечная точка WCF. Однако если при запуске конечной точки произойдет сбой, мы просто запишем в журнал событие 6800 и разрешим запуск службы синхронизации. Наличие этого события означает, что конечная точка обратной записи паролей не была запущена. Подробные сведения в журнале об этом событии (6800) наряду с записями журнала событий, созданными компонентом PasswordResetService компонентов, покажут, почему конечную точку не удалось запустить. Просмотрите эти ошибки в журнале событий и попробуйте заново запустить Azure AD Connect, если обратная запись паролей все еще не работает. Если проблема сохранится, попробуйте отключить и повторно включить обратную запись паролей.</p>
            </td>
          </tr>
					<tr>
            <td>
              <p>Когда пользователь пытается сбросить пароль или разблокировать учетную запись с включенным компонентом обратной записи паролей, операция завершается ошибкой. Кроме того, после операции блокировки в журнале событий Azure AD Connect отображается событие со следующим сообщением: "Обработчик синхронизации вернул ошибку hr=800700CE, сообщение=Слишком длинное имя файла или расширение".
							</p>
            </td>
            <td>
              <p>Это может произойти, если вы обновили предыдущие версии Azure AD Connect или DirSync. В случае установки более старых версий Azure AD Connect для учетной записи агента управления Azure AD задается пароль длиной 254 символа. В случае установки более новых версий задается пароль длиной 127 символов. Такие длинные пароли используются в операциях экспорта и импорта соединителя AD, но не поддерживаются операцией разблокировки.
							</p>
            </td>
            <td>
              <p>[Найдите учетную запись Active Directory](active-directory-aadconnect-accounts-permissions.md#active-directory-account) для Azure AD Connect и сбросьте пароль, чтобы он содержал не более 127 символов. Затем запустите **службу синхронизации** из меню "Пуск". Перейдите в раздел **Соединители** и найдите **соединитель Active Directory**. Выберите его и щелкните **Свойства**. Перейдите на страницу **учетных данных** и введите новый пароль. Нажмите кнопку **ОК**, чтобы закрыть страницу.
							</p>
            </td>
          </tr>
					<tr>
            <td>
              <p>Ошибка при настройке обратной записи во время установки Azure AD Connect.</p>
            </td>
            <td>
              <p>На последнем шаге процесса установки Azure AD Connect появляется ошибка с сообщением о том, что обратную запись паролей не удалось настроить.</p>
              <p>

              </p>
              <p>Журнал событий приложения Azure AD Connect содержит ошибку 32009 с текстом «Ошибка при получении токена авторизации».</p>
            </td>
            <td>
              <p>Эта ошибка возникает в следующих двух случаях:</p>
              <ul>
                <li class="unordered">
										Указан неправильный пароль для учетной записи глобального администратора, указанной в начале процесса установки Azure AD Connect.<br\><br\></li>
              </ul>
              <ul>
                <li class="unordered">
										Предпринята попытка использовать федеративного пользователя для учетной записи глобального администратора, указанной в начале процесса установки Azure AD Connect.<br\><br\></li>
              </ul>
              <p>Чтобы устранить эту ошибку, убедитесь в том, что вы не используете федеративную учетную запись для глобального администратора, указанного в начале процесса установки Azure AD Connect, и что пароль указан правильно.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>Ошибка при настройке обратной записи во время установки Azure AD Connect.</p>
            </td>
            <td>
              <p>Журнал событий компьютера Azure AD Connect содержит ошибку 32002, выданную службой PasswordResetService.</p>
              <p>

              </p>
              <p>Текст сообщения об ошибке: «Ошибка подключения к служебной шине. Поставщику токенов не удалось предоставить токен безопасности...»</p>
              <p>

              </p>
            </td>
            <td>
              <p>Основной причиной этой ошибки является то, что служба сброса паролей, работающая в вашей локальной среде, не может подключиться к конечной точке шины обслуживания в облаке. Эта ошибка обычно вызывается правилом брандмауэра, блокирующим исходящее подключение к конкретному порту или веб-адресу.</p>
              <p>

              </p>
              <p>Убедитесь, что брандмауэр разрешает исходящие соединения для следующих настроек:</p>
              <ul>
                <li class="unordered">
										Весь трафик через TCP 443 (HTTPS)<br\><br\></li>
              </ul>
              <ul>
                <li class="unordered">
										Исходящие подключения к <br\><br\></li>
              </ul>
              <p>

              </p>
              <p>После обновления этих правил перезагрузите компьютер Azure AD Connect, и обратная запись паролей должна снова начать работать.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>Конечная точка обратной записи паролей локально недоступна</p>
            </td>
            <td>
              <p>После работы в течение некоторого времени федеративные пользователи или пользователи с синхронизацией хэшей паролей не могут сбрасывать пароли.</p>
            </td>
            <td>
              <p>В некоторых редких случаях службе обратной записи паролей не удается перезапуститься после перезапуска Azure AD Connect. В этих случаях сначала проверьте, включена ли обратная запись паролей локально. Это можно сделать с помощью мастера Azure AD Connect или Powershell (см. раздел практических руководств выше). Если данная функция выглядит включенной, попробуйте еще раз включить или отключить эту функцию либо через пользовательский интерфейс, либо через PowerShell. См. «Шаг 2. Включение обратной записи паролей на компьютере синхронизации каталогов и настройка правил брандмауэра» в разделе <a href="active-directory-passwords-getting-started.md#enable-users-to-reset-or-change-their-ad-passwords">Включение или отключение обратной записи паролей</a> для получения дополнительных сведений о том, как это сделать.</p>
              <p>

              </p>
              <p>Если это не поможет, попробуйте полностью удалить и заново установить Azure AD Connect.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>Ошибки разрешений</p>
            </td>
            <td>
              <p>Федеративные пользователи или пользователи с синхронизацией хэшей паролей, которые пытаются сбросить свои пароли, после отправки пароля видят ошибку, указывающую на проблему со службой.</p>
              <p>

              </p>
              <p>Кроме того, во время операций сброса пароля вы можете увидеть ошибку, связанную с тем, что агенту управления было отказано в доступе к журналам событий в локальной системе.</p>
            </td>
            <td>
              <p>Если эти ошибки отображаются в вашем журнале событий, убедитесь, что учетная запись AD MA (которая была указано в мастере во время настройки) обладает необходимыми разрешениями для обратной записи паролей.</p>
              <p>

              </p>
              <p>Обратите внимание, что после предоставления этого разрешения может потребоваться до 1 часа для распространения разрешений посредством фоновой задачи sdprop на контроллере домена. </p>
              <p>Для работы сброса пароля разрешение необходимо установить на дескрипторе безопасности объекта пользователя, пароль которого сбрасывается. До тех пор пока это разрешение не отобразится на объекте пользователя, сброс пароля будет завершаться отказом в доступе.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>Ошибка при настройке обратной записи паролей из мастера настройки Azure AD Connect </p>
            </td>
            <td>
              <p>Ошибка «Не удается найти MA» в мастере при включении или отключении обратной записи паролей</p>
            </td>
            <td>
              <p>Существует известная программная ошибка в окончательной версии Azure AD Connect, которая проявляется в следующей ситуации.</p>
              <ol class="ordered">
                <li>
										Вы выполняете настройку Azure Connect AD для клиента abc.com (проверенный домен) с использованием учетных данных. Это приводит к созданию соединителя AAD с именем «abc.com – AAD».<br\><br\></li>
                <li>
										Затем вы изменяете учетные данные AAD для соединителя (с использованием старого пользовательского интерфейса синхронизации) на (обратите внимание, что это тот же клиент, но с другим именем домена). <br\><br\></li>
                <li>
										Теперь вы пытаетесь включить или отключить обратную запись паролей. Мастер сформирует имя соединителя, используя учетные данные, как «abc.onmicrosoft.com – AAD» и передаст его командлету обратной записи паролей. Это вызовет сбой, поскольку соединитель с таким именем не создан.<br\><br\></li>
              </ol>
              <p>Это было исправлено в наших новейших сборках. Если у вас более старая сборка, одно возможное решение&#160;— использовать командлет powershell для включения или отключения этой функции. См. «Шаг 2. Включение обратной записи паролей на компьютере синхронизации каталогов и настройка правил брандмауэра» в разделе <a href="active-directory-passwords-getting-started.md#enable-users-to-reset-or-change-their-ad-passwords">Включение или отключение обратной записи паролей</a> для получения дополнительных сведений о том, как это сделать.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>Не удается сбросить пароль для пользователей в специальных группах, таких как «Администраторы домена», «Администраторы предприятия» и т. д.</p>
            </td>
            <td>
              <p>Федеративные пользователи или пользователи с синхронизацией хэшей паролей, которые являются частью защищенных групп и пытаются сбросить свои пароли, после отправки пароля видят ошибку, указывающую на проблему со службой.</p>
            </td>
            <td>
              <p>Привилегированные пользователи в Active Directory защищены с помощью AdminSDHolder. См. статью <a href="https://technet.microsoft.com/magazine/2009.09.sdadminholder.aspx">http://technet.microsoft.com/magazine/2009.09.sdadminholder.aspx</a> для получения дополнительных сведений. </p>
              <p>

              </p>
              <p>Это означает, что дескрипторы безопасности в таких объектах периодически проверяются для соответствия указанному в AdminSDHolder и сбрасываются, если они различаются. Поэтому дополнительные разрешения, которые необходимы для обратной записи паролей, не распространяются на таких пользователей. В результате обратная запись паролей для таких пользователей может не работать. Вследствие этого мы не поддерживаем управление паролями для пользователей в этих группах, так как это нарушает модель безопасности AD.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>Происходит сбой операций сброса с сообщением «Объект не найден»</p>
            </td>
            <td>
              <p>Федеративные пользователи или пользователи с синхронизацией хэшей паролей, которые пытаются сбросить свои пароли, после отправки пароля видят ошибку, указывающую на проблему со службой.</p>
              <p>

              </p>
              <p>Кроме того, во время операций сброса пароля в журналах событий может появиться ошибка службы Azure AD Connect с сообщением «Объект не найден».</p>
            </td>
            <td>
              <p>Эта ошибка обычно указывает, что обработчику синхронизации не удалось найти либо объект пользователя в пространстве соединителя AAD, либо связанный объект пространства соединителя MV или AD. </p>
              <p>

              </p>
              <p>Для решения этой проблемы убедитесь, что пользователь действительно синхронизирован из локальной среды в AAD через текущий экземпляр Azure AD Connect, и проверьте состояние объектов в пространствах соединителей и MV. Убедитесь, что объект AD CS является соединителем для объекта MV через правило «Microsoft.InfromADUserAccountEnabled.xxx».</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>Операции сброса завершаются ошибкой «Найдено несколько соответствий»</p>
            </td>
            <td>
              <p>Федеративные пользователи или пользователи с синхронизацией хэшей паролей, которые пытаются сбросить свои пароли, после отправки пароля видят ошибку, указывающую на проблему со службой.</p>
              <p>

              </p>
              <p>Кроме того, во время операций сброса пароля в журналах событий может появиться ошибка службы Azure AD Connect с сообщением «Найдено несколько соответствий».</p>
            </td>
            <td>
              <p>Это означает, что обработчик синхронизации обнаружил, что объект MV подключен к нескольким объектам AD CS через «Microsoft.InfromADUserAccountEnabled.xxx». Это означает, что у пользователя включена учетная запись в нескольких лесах. </p>
              <p>

              </p>
              <p>В настоящее время такой сценарий не поддерживается для обратной записи паролей.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>Операции с паролем вызывают ошибку конфигурации.</p>
            </td>
            <td>
              <p>Операции с паролем вызывают ошибку конфигурации. Журнал событий приложений содержит ошибку Azure AD Connect 6329 с текстом: 0x8023061f (Операция не удалась, поскольку для данного агента управления не включена синхронизация паролей).</p>
            </td>
            <td>
              <p>Это происходит при изменении конфигурации Azure AD Connect для добавления нового леса AD (или для удаления и повторного добавления существующего леса) <strong>после</strong> того, как функция обратной записи паролей уже была включена. Операции с паролями для пользователей в таких новых добавленных лесах завершатся ошибкой. Чтобы исправить эту проблему, отключите и повторно включите обратную запись паролей после изменения конфигурации леса.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>Обратная запись паролей, которые были сброшены пользователями, работает правильно, но обратная запись паролей, измененных пользователем или сброшенных для него администратором, приводит к ошибке.</p>
            </td>
            <td>
              <p>При попытке выполнить сброс пароля от имени пользователя на портале управления Azure появится сообщение: «Служба сброса паролей, запущенная в вашей локальной среде, не поддерживает сброс паролей пользователей администраторами. Выполните обновление до новейшей версии Azure AD Connect для решения этой проблемы.»</p>
            </td>
            <td>
              <p>Это происходит, когда версия обработчика синхронизации не поддерживает определенную операцию обратной записи паролей, которая была использована. Версии Azure AD Connect после 1.0.0419.0911 поддерживают все операции управления паролями, включая обратную запись сброса пароля, обратную запись изменения пароля и обратную запись инициированного администратором сброса пароля, на портале управления Azure.&#160; Версии DirSync после 1.0.6862 поддерживают только обратную запись сброса пароля. Чтобы устранить эту проблему, настоятельно рекомендуется установить новейшую версию Azure AD Connect или Azure Active Directory Connect (дополнительные сведения см. в разделе <a href="active-directory-aadconnect">Средства интеграции каталогов</a>), которая устранит неполадку и позволит использовать преимущества обратной записи паролей в вашей организации.</p>
            </td>
          </tr>
        </tbody></table>


## Коды ошибок журнала событий обратной записи паролей
Рекомендуемой практикой при устранении неполадок с обратной записи паролей является проверка соответствующего журнала событий приложений на компьютере Azure AD Connect. Этот журнал событий будет содержать события из двух источников, представляющих интерес в плане обратной записи паролей. В источнике PasswordResetService будут описаны операции и вопросы, относящиеся к работе обратной записи паролей. В источнике ADSync будут описаны операции и проблемы, связанные с установкой паролей в среде AD.

<table>
          <tbody><tr>
            <td>
              <p>
                <strong>Код</strong>
              </p>
            </td>
            <td>
              <p>
                <strong>Имя/сообщение</strong>
              </p>
            </td>
            <td>
              <p>
                <strong>Источник</strong>
              </p>
            </td>
            <td>
              <p>
                <strong>Описание</strong>
              </p>
            </td>
          </tr>
          <tr>
            <td>
              <p>6329</p>
            </td>
            <td>
              <p>BAIL: MMS(4924) 0x80230619&#160;– «Ограничение препятствует изменению пароля на текущий указанный.»</p>
            </td>
            <td>
              <p>ADSync</p>
            </td>
            <td>
              <p>Это событие возникает при попытке службы обратной записи паролей установить на ваш локальный каталог пароль, который не соответствует требованиям домена к сроку действия пароля, истории, сложности или фильтрации.</p>
              <ul>
                <li class="unordered">
										Если установлен минимальный срок действия пароля и пароль был недавно изменен в пределах заданного окна времени, вы не сможете изменить пароль снова, пока не истечет определенный период времени в вашем домене. В целях тестирования минимальный срок действия должен быть установлен равным 0.<br\><br\></li>
              </ul>
              <ul>
                <li class="unordered">
										Если включены требования к истории паролей, то необходимо выбрать пароль, который не использовался последние N раз, где N&#160;— настройка истории паролей. При выборе пароля, который использовался в последние N раз, в данном случае возникнет ошибка. В целях тестирования значение истории паролей должно быть установлено равным 0.<br\><br\></li>
              </ul>
              <ul>
                <li class="unordered">
										При наличии требований к сложности пароля все они будут применяться при попытке пользователя изменить или сбросить пароль.<br\><br\></li>
              </ul>
              <ul>
                <li class="unordered">
										Если включены фильтры паролей, а пользователь выбирает пароль, которые не соответствуют критериям фильтрации, то операция сброса или изменения завершится ошибкой.<br\><br\></li>
              </ul>
            </td>
          </tr>
          <tr>
            <td>
              <p>HR 8023042</p>
            </td>
            <td>
              <p>Обработчик синхронизации вернул ошибку hr=80230402 с сообщением: «Попытка получить объект завершилась ошибкой, так как существуют повторяющиеся записи с одной привязкой».</p>
            </td>
            <td>
              <p>ADSync</p>
            </td>
            <td>
              <p>Это событие возникает, когда один идентификатор пользователя включен в нескольких доменах. Например, если идет синхронизация лесов учетных записей и ресурсов, и в каждом из них включен один и тот же идентификатор пользователя, может произойти эта ошибка.  </p>
              <p>Также эта ошибка может возникнуть, если вы используете атрибут неуникальной привязки (например, псевдоним или имя участника-пользователя) и два пользователя используют одинаковый атрибут привязки.</p>
              <p>Чтобы устранить эту проблему, убедитесь, что в пределах доменов нет повторяющихся пользователей и для каждого пользователя используется атрибут уникальной привязки.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>31001</p>
            </td>
            <td>
              <p>PasswordResetStart </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Это событие указывает, что локальная служба обнаружила запрос на сброс пароля для федеративного пользователя или пользователя с синхронизацией хэшей паролей, исходящий из облака. Это событие является первым событием в каждой операции обратной записи сброса пароля.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>31002</p>
            </td>
            <td>
              <p>PasswordResetSuccess </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Это событие указывает, что пользователь выбрал новый пароль во время операции сброса пароля, мы определили, что этот пароль соответствует требованиям организации к паролю, и он успешно был записан обратно в локальную среду AD.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>31003</p>
            </td>
            <td>
              <p>PasswordResetFail </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Это событие указывает, что пользователь выбрал пароль, этот пароль успешно поступил в локальную среду, но при попытке установить его в локальной среде AD произошел сбой. Это может произойти по нескольким причинам.</p>
              <ul>
                <li class="unordered">
										Пароль пользователя не соответствует требованиям домена к сроку действия, истории, сложности или фильтрации. Попробуйте для решения задать совершенно новый пароль.<br\><br\></li>
              </ul>
              <ul>
                <li class="unordered">
										Учетная запись службы MA не имеет соответствующих разрешений на установку нового пароля для нужной учетной записи пользователя.<br\><br\></li>
              </ul>
              <ul>
                <li class="unordered">
										Учетная запись пользователя находится в защищенной группе, например администраторов домена или предприятия, которая запрещает операции установки пароля.<br\><br\></li>
              </ul>
              <p>См. раздел <a href="#troubleshoot-password-writeback">Устранение неполадок обратной записи паролей</a> для получения дополнительных сведений о том, какие еще ситуации могут вызывать эту ошибку.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>31004</p>
            </td>
            <td>
              <p>OnboardingEventStart </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Это событие возникает, если включена обратная запись паролей с помощью Azure AD Connect, и указывает, что начата адаптация вашей организации к веб-службе обратной записи паролей.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>31005</p>
            </td>
            <td>
              <p>OnboardingEventSuccess </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Это событие указывает, что процесс адаптации прошел успешно и возможности обратной записи паролей готовы к использованию.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>31006</p>
            </td>
            <td>
              <p>ChangePasswordStart </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Это событие указывает, что локальная служба обнаружила запрос на изменение пароля для федеративного пользователя или пользователя с синхронизацией хэшей паролей, исходящий из облака. Это событие является первым событием в каждой операции обратной записи изменения пароля.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>31007</p>
            </td>
            <td>
              <p>ChangePasswordSuccess </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Это событие указывает, что пользователь выбрал новый пароль во время операции изменения пароля, мы определили, что этот пароль соответствует требованиям организации к паролю, и он успешно был записан обратно в локальную среду AD.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>31008</p>
            </td>
            <td>
              <p>ChangePasswordFail </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Это событие указывает, что пользователь выбрал пароль, этот пароль успешно поступил в локальную среду, но при попытке установить его в локальной среде AD произошел сбой. Это может произойти по нескольким причинам.</p>
              <ul>
                <li class="unordered">
										Пароль пользователя не соответствует требованиям домена к сроку действия, истории, сложности или фильтрации. Попробуйте для решения задать совершенно новый пароль.<br\><br\></li>
              </ul>
              <ul>
                <li class="unordered">
										Учетная запись службы MA не имеет соответствующих разрешений на установку нового пароля для нужной учетной записи пользователя.<br\><br\></li>
              </ul>
              <ul>
                <li class="unordered">
										Учетная запись пользователя находится в защищенной группе, например администраторов домена или предприятия, которая запрещает операции установки пароля.<br\><br\></li>
              </ul>
              <p>См. раздел <a href="#troubleshoot-password-writeback">Устранение неполадок обратной записи паролей</a> для получения дополнительных сведений о том, какие другие ситуации могут вызывать эту ошибку.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>31009</p>
            </td>
            <td>
              <p>ResetUserPasswordByAdminStart </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Локальная служба обнаружила запрос на сброс пароля для федеративного пользователя или пользователя с синхронизацией хэшей паролей, исходящий от администратора от имени пользователя. Это событие является первым событием в каждой операции обратной записи инициированного администратором сброса пароля.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>31010</p>
            </td>
            <td>
              <p>ResetUserPasswordByAdminSuccess </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Администратор выбрал новый пароль во время операции инициированного администратором сброса пароля. Мы определили, что этот пароль соответствует требованиям организации к паролю, и он успешно был записан обратно в локальную среду AD.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>31011</p>
            </td>
            <td>
              <p>ResetUserPasswordByAdminFail </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Администратор выбрал пароль от имени пользователя, этот пароль успешно поступил в локальную среду, но при попытке установить его в локальной среде AD произошел сбой. Это может произойти по нескольким причинам.</p>
              <ul>
                <li class="unordered">
										Пароль пользователя не соответствует требованиям домена к сроку действия, истории, сложности или фильтрации. Попробуйте для решения задать совершенно новый пароль.<br\><br\></li>
              </ul>
              <ul>
                <li class="unordered">
										Учетная запись службы MA не имеет соответствующих разрешений на установку нового пароля для нужной учетной записи пользователя.<br\><br\></li>
              </ul>
              <ul>
                <li class="unordered">
										Учетная запись пользователя находится в защищенной группе, например администраторов домена или предприятия, которая запрещает операции установки пароля.<br\><br\></li>
              </ul>
              <p>См. раздел <a href="#troubleshoot-password-writeback">Устранение неполадок обратной записи паролей</a> для получения дополнительных сведений о том, какие еще ситуации могут вызывать эту ошибку.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>31012</p>
            </td>
            <td>
              <p>OffboardingEventStart </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Это событие возникает, если отключить обратную запись паролей с помощью Azure AD Connect, и указывает, что начата отмена адаптации вашей организации к веб-службе обратной записи паролей.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>31013</p>
            </td>
            <td>
              <p>OffboardingEventSuccess </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Это событие указывает, что процесс отмены адаптации прошел успешно и возможности обратной записи паролей успешно отключены.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>31014</p>
            </td>
            <td>
              <p>OffboardingEventFail </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Это событие указывает, что процесс отмены адаптации не был успешным. Это могло произойти из-за ошибка разрешений в облаке или локальной учетной записи администратора, указанной во время настройки, или потому, что вы пытаетесь использовать федеративного облачного глобального администратора при отключении обратной записи паролей. Чтобы устранить эту проблему, проверьте свои разрешения на администрирование и убедитесь, что вы не используете никакую федеративную учетную запись при настройке функции обратной записи паролей.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>31015</p>
            </td>
            <td>
              <p>WriteBackServiceStarted </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Это событие указывает, что служба обратной записи паролей успешно запущена и готова к приему запросов на управление паролями из облака.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>31016</p>
            </td>
            <td>
              <p>WriteBackServiceStopped </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Это событие указывает, что служба обратной записи паролей была остановлена, и любые запросы управления паролями из облака не будут успешно выполнены.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>31017</p>
            </td>
            <td>
              <p>AuthTokenSuccess </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Это событие указывает, что мы успешно получили токен авторизации для глобального администратора, указанного во время установки Azure AD Connect, для запуска процесса адаптации или отмены адаптации.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>31018</p>
            </td>
            <td>
              <p>KeyPairCreationSuccess </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Это событие указывает, что мы успешно создали ключ шифрования паролей, который будет использоваться для шифрования паролей из облака для отправки в вашу локальную среду.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>32000</p>
            </td>
            <td>
              <p>UnknownError </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Это событие указывает на неизвестную ошибку во время операции управления паролями. Просмотрите текст исключения в событии для получения дополнительных сведений. Если возникают проблемы, попробуйте отключить и повторно включить обратную запись паролей. Если это не помогло, включите копию журнала событий вместе с указанным внутри идентификатор отслеживания и отправьте сотруднику службы поддержки.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>32001</p>
            </td>
            <td>
              <p>ServiceError </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Это событие указывает, что произошла ошибка при подключении к облачной службе сброса паролей, и обычно происходит в случае, когда локальной службе не удалось подключиться к веб-службе сброса пароля. </p>
            </td>
          </tr>
          <tr>
            <td>
              <p>32002</p>
            </td>
            <td>
              <p>ServiceBusError </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Это событие указывает, что произошла ошибка при подключении к экземпляру шины обслуживания вашего клиента. Это может произойти из-за того, что в вашей локальной среде блокируются исходящие подключения. Проверьте брандмауэр, убедившись, что разрешены подключения через TCP-порт 443 к <a href="https://ssprsbprodncu-sb.accesscontrol.windows.net/">https://ssprsbprodncu-sb.accesscontrol.windows.net/</a>, и повторите попытку. Если проблемы продолжаются, попробуйте отключить и повторно включить обратную запись паролей.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>32003</p>
            </td>
            <td>
              <p>InPutValidationError </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Это событие указывает, что входные данные, переданные в API нашей веб-службы, были недопустимыми. Попробуйте выполнить операцию заново.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>32004</p>
            </td>
            <td>
              <p>DecryptionError </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Это событие указывает, что произошла ошибка при расшифровке пароля, который поступил из облака. Это может быть из-за несовпадения ключей расшифровки между облачной службой и локальной средой. Чтобы решить эту проблему, отключите и снова включите обратную запись паролей в локальной среде.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>32005</p>
            </td>
            <td>
              <p>ConfigurationError </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Во время адаптации мы сохраняем сведения для конкретного клиента в файле конфигурации в локальной среде. Это событие указывает, что произошла ошибка при сохранении этого файла или при запуске службы произошла ошибка чтения файла. Чтобы устранить эту проблему, попробуйте отключить и повторно включить обратную запись паролей для принудительной перезаписи данного файла конфигурации. </p>
            </td>
          </tr>
          <tr>
            <td>
              <p>32006</p>
            </td>
            <td>
              <p>EndPointConfigurationError </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>НЕ РЕКОМЕНДУЕТСЯ&#160;— Это событие отсутствует в Azure AD Connect и присутствует только в очень ранних сборках DirSync, которые поддерживали обратную запись.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>32007</p>
            </td>
            <td>
              <p>OnBoardingConfigUpdateError </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Во время адаптации мы отправляем данные из облака в локальную службу сброса паролей. Эти данные затем записываются в файл, размещенный в памяти, перед отправкой в службу синхронизации для безопасного хранения этих сведений на диске. Это событие указывает на проблему при записи или обновлении таких данных в памяти. Чтобы устранить эту проблему, попробуйте отключить и повторно включить обратную запись паролей для принудительной перезаписи данной конфигурации.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>32008</p>
            </td>
            <td>
              <p>ValidationError </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Это событие указывает, что был получен недопустимый ответ от веб-службы сброса паролей. Чтобы устранить проблему, попробуйте отключить и повторно включить обратную запись паролей.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>32009</p>
            </td>
            <td>
              <p>AuthTokenError </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Это событие указывает, что нам не удалось получить токен авторизации для учетной записи глобального администратора, указанной во время установки Azure AD Connect. Эта ошибка может быть вызвана неверным именем пользователя или паролем, указанным для учетной записи глобального администратора, или же тем, что указанная учетная запись глобального администратора является федеративной. Чтобы устранить эту проблему, повторно запустите конфигурацию с правильными именем пользователя и паролем и убедитесь, что учетная запись администратора является управляемой (только облачной или с синхронизацией паролей).</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>32010</p>
            </td>
            <td>
              <p>CryptoError </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Это событие указывает, что произошла ошибка при создании ключа шифрования пароля или при расшифровке пароля, поступившего из облачной службы. Скорее всего, эта ошибка указывает на возможную неполадку среды. Просмотрите подробности в журнале событий для получения дополнительных сведений и устранения этой проблемы. Также можно попробовать отключить и повторно включить службу обратной записи паролей для решения этой проблемы.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>32011</p>
            </td>
            <td>
              <p>OnBoardingServiceError </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Это событие указывает, что локальной службе не удалось правильно связаться с веб-службой сброса паролей для запуска процесса адаптации. Это может быть из-за правил брандмауэра или проблемы при получении токена авторизации для вашего клиента. Чтобы устранить эту проблему, убедитесь, что не блокируются исходящие подключения через TCP-порты 443 и 9350-9354 или к <a href="https://ssprsbprodncu-sb.accesscontrol.windows.net/">https://ssprsbprodncu-sb.accesscontrol.windows.net/</a>, а также что учетная запись администратора AAD, используемая для адаптации, не является федеративной. </p>
            </td>
          </tr>
          <tr>
            <td>
              <p>32012</p>
            </td>
            <td>
              <p>OnBoardingServiceDisableError </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>НЕ РЕКОМЕНДУЕТСЯ&#160;— Это событие отсутствует в Azure AD Connect и присутствует только в очень ранних сборках DirSync, которые поддерживали обратную запись.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>32013</p>
            </td>
            <td>
              <p>OffBoardingError </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Это событие указывает, что локальной службе не удалось правильно связаться с веб-службой сброса паролей для запуска процесса отмены адаптации. Это может быть из-за правил брандмауэра или проблемы при получении токена авторизации для вашего клиента. Чтобы устранить эту проблему, убедитесь, что не блокируются исходящие подключения через порт 443 или к <a href="https://ssprsbprodncu-sb.accesscontrol.windows.net/">https://ssprsbprodncu-sb.accesscontrol.windows.net/</a>, а также что учетная запись администратора AAD, используемая для отмены адаптации, не является федеративной. </p>
            </td>
          </tr>
          <tr>
            <td>
              <p>32014</p>
            </td>
            <td>
              <p>ServiceBusWarning </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Это событие указывает, что нам необходимо было повторить попытку подключения к экземпляру шины обслуживания вашего клиента. В обычных условиях это не должно быть проблемой, однако если событие повторяется множество раз, рекомендуется проверить сетевое подключение к шине обслуживания, особенно в случае подключения с высокой задержкой или низкой пропускной способностью.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>32015</p>
            </td>
            <td>
              <p>ReportServiceHealthError </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Для мониторинга работоспособности службы обратной записи паролей мы отправляем данные пульса в веб-службу сброса паролей каждые 5 минут. Это событие указывает, что произошла ошибка при отправке такой информации о работоспособности обратно в облачную веб-службу. Такая информация о работоспособности не включает в себя данные OII или PII и представляет собой исключительно сигнал пульса и базовую статистику службы для того, чтобы можно было предоставлять сведения о состоянии службы в облаке.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>33001</p>
            </td>
            <td>
              <p>ADUnKnownError </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Это событие указывает, что возникла неизвестная ошибка, возвращенная AD. Проверьте журнал событий сервера Azure AD Connect на наличие событий из источника ADSync для получения дополнительных сведений об этой ошибке.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>33002</p>
            </td>
            <td>
              <p>ADUserNotFoundError </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Это событие указывает, что пользователь, который пытается сбросить или изменить пароль, не найден в локальном каталоге. Это может произойти, если пользователь был удален локально, но не в облаке, или при наличии проблемы с синхронизацией. Проверьте журналы синхронизации, а также подробности о последних нескольких запусках синхронизации для получения дополнительных сведений.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>33003</p>
            </td>
            <td>
              <p>ADMutliMatchError </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Если запрос на сброс или изменение пароля исходит из облака, мы используем облачную привязку, указанную в процессе установки Azure AD Connect, для определения способа связи этого запроса обратно с пользователем в локальной среде. Это событие указывает, что в локальном каталоге найдены два пользователя с одним и тем же атрибутом облачной привязки. Проверьте журналы синхронизации, а также подробности о последних нескольких запусках синхронизации для получения дополнительных сведений.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>33004</p>
            </td>
            <td>
              <p>ADPermissionsError </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Это событие указывает, что учетная запись службы агента управления не имеет соответствующих разрешений на запрашиваемую учетную запись, чтобы задать новый пароль. Убедитесь, что учетная запись MA в лесу пользователя имеет разрешения на сброс и изменение пароля для всех объектов в лесу. Дополнительные сведения о том, как это сделать, см. в разделе <a href="active-directory-passwords-getting-started.md#step-4-set-up-the-appropriate-active-directory-permissions">Шаг 4. Настройка соответствующих разрешений Active Directory</a>.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>33005</p>
            </td>
            <td>
              <p>ADUserAccountDisabled </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Это событие указывает, что мы пытались сбросить или изменить пароль для учетной записи, которая была отключена на локальном компьютере. Включите учетную запись и повторите попытку.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>33006</p>
            </td>
            <td>
              <p>ADUserAccountLockedOut </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Событие указывает, что мы пытались сбросить или изменить пароль для учетной записи, которая была заблокирована на локальном компьютере. Блокировки могут происходить при слишком большом количестве попыток пользователя изменить или сбросить пароль за короткий период. Разблокируйте учетную запись и повторите попытку.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>33007</p>
            </td>
            <td>
              <p>ADUserIncorrectPassword </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Это событие указывает, что пользователь задал неверный текущий пароль при выполнении операции смены пароля. Укажите правильный текущий пароль и повторите попытку.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>33008</p>
            </td>
            <td>
              <p>ADPasswordPolicyError </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Это событие возникает при попытке службы обратной записи паролей установить на ваш локальный каталог пароль, который не соответствует требованиям домена к сроку действия пароля, истории, сложности или фильтрации.</p>
              <ul>
                <li class="unordered">
										Если установлен минимальный срок действия пароля и пароль был недавно изменен в пределах заданного окна времени, вы не сможете изменить пароль снова, пока не истечет определенный период времени в вашем домене. В целях тестирования минимальный срок действия должен быть установлен равным 0.<br\><br\></li>
              </ul>
              <ul>
                <li class="unordered">
										Если включены требования к истории паролей, то необходимо выбрать пароль, который не использовался последние N раз, где N&#160;— настройка истории паролей. При выборе пароля, который использовался в последние N раз, в данном случае возникнет ошибка. В целях тестирования значение истории паролей должно быть установлено равным 0.<br\><br\></li>
              </ul>
              <ul>
                <li class="unordered">
										При наличии требований к сложности пароля все они будут применяться при попытке пользователя изменить или сбросить пароль.<br\><br\></li>
              </ul>
              <ul>
                <li class="unordered">
										Если включены фильтры паролей, а пользователь выбирает пароль, которые не соответствуют критериям фильтрации, то операция сброса или изменения завершится ошибкой.<br\><br\></li>
              </ul>
            </td>
          </tr>
          <tr>
            <td>
              <p>33009</p>
            </td>
            <td>
              <p>ADConfigurationError </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>Это событие указывает, что возникла проблема при записи пароля обратно в локальный каталог из-за неполадки с конфигурацией в Active Directory. Проверьте журнал событий приложений компьютера Azure AD Connect на наличие сообщений от службы ADSync для получения дополнительных сведений о том, какая ошибка произошла. </p>
            </td>
          </tr>
          <tr>
            <td>
              <p>34001</p>
            </td>
            <td>
              <p>ADPasswordPolicyOrPermissionError </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>НЕ РЕКОМЕНДУЕТСЯ&#160;— Это событие отсутствует в Azure AD Connect и присутствует только в очень ранних сборках DirSync, которые поддерживали обратную запись.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>34002</p>
            </td>
            <td>
              <p>ADNotReachableError </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>НЕ РЕКОМЕНДУЕТСЯ&#160;— Это событие отсутствует в Azure AD Connect и присутствует только в очень ранних сборках DirSync, которые поддерживали обратную запись.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>34003</p>
            </td>
            <td>
              <p>ADInvalidAnchorError </p>
            </td>
            <td>
              <p>PasswordResetService</p>
            </td>
            <td>
              <p>НЕ РЕКОМЕНДУЕТСЯ&#160;— Это событие отсутствует в Azure AD Connect и присутствует только в очень ранних сборках DirSync, которые поддерживали обратную запись.</p>
            </td>
          </tr>
        </tbody></table>

## Устранение неполадок подключения обратной записи паролей

Если при работе с компонентом обратной записи паролей Azure AD Connect наблюдаются нарушения работы службы, ниже приведен ряд быстрых действий, которые можно предпринять для решения этой проблемы.

 - [Перезапуск службы синхронизации Azure AD Connect](#restart-the-azure-AD-Connect-sync-service)
 - [Отключение и повторное включение функции обратной записи паролей](#disable-and-re-enable-the-password-writeback-feature)
 - [Установка новейшей версии Azure AD Connect](#install-the-latest-azure-ad-connect-release)
 - [Устранение неполадок с обратной записью паролей](#troubleshoot-password-writeback)

В общем случае рекомендуется выполнить следующие действия в указанном выше порядке для максимально быстрого восстановления работы службы.

### Перезапуск службы синхронизации Azure AD Connect
Перезапуск службы синхронизации Azure AD Connect может помочь в решении проблем с подключением или других временных проблем со службой.

 1.	От имени администратора нажмите кнопку **Пуск** на сервере, на котором работает программное обеспечение **Azure AD Connect**.
 2.	Введите **services.msc** в поле поиска и нажмите клавишу **Enter**.
 3.	Найдите запись **Microsoft Azure AD Connect**.
 4.	Щелкните правой кнопкой мыши запись службы, выберите команду **Перезапустить** и дождитесь завершения операции.

    ![][002]

Эти шаги позволяют восстановить подключение к облачной службе и устранить возможные перебои в работе. Если перезапуск службы синхронизации не решил проблему, рекомендуется попробовать отключить и повторно включить функцию обратной записи паролей в качестве следующего шага.

### Отключение и повторное включение функции обратной записи паролей
Отключение и повторное включение функции обратной записи паролей может помочь устранить проблемы с подключением.

 1.	От имени администратора откройте **Мастер настройки Azure AD Connect**.
 2.	В диалоговом окне **Подключение к Azure AD** введите ваши **учетные данные глобального администратора Azure AD**
 3.	В диалоговом окне **Подключение к AD DS** введите ваши **учетные данные администратора доменных служб AD**.
 4.	В диалоговом окне **Уникальная идентификация пользователей** нажмите кнопку **Далее**.
 5.	В диалоговом окне **Дополнительные возможности** снимите флажок **Обратная запись пароля**.

    ![][003]

 6.	Нажимайте кнопку **Далее** на оставшихся страницах диалогового окна, ничего не изменяя, пока не дойдете до страницы **Готово к настройке**.
 7.	Убедитесь, что на странице настройки отображается **параметр «Обратная запись пароля» как отключенный**, и нажмите зеленую кнопку **Настройка**, чтобы сохранить изменения.
 8.	В диалоговом окне **Завершено** отмените выбор параметра **Синхронизировать сейчас**, а затем нажмите кнопку **Готово** для завершения работы мастера.
 9.	Повторно откройте **Мастер настройки Azure AD Connect**.
 10.	**Повторите шаги 2–8**, за исключением того, что **флажок «Обратная запись пароля» должен быть установлен** на экране **Дополнительные возможности**, чтобы включить службу.

    ![][004]

Эти шаги позволяют восстановить подключение к нашей облачной службе и устранить возможные перебои в работе.

Если отключение и повторное включение функции обратной записи паролей не решило проблему, рекомендуется попробовать переустановить Azure AD Connect в качестве следующего шага.

### Установка новейшей версии Azure AD Connect
Переустановка пакета Azure AD Connect устранит возможные проблемы конфигурации, которые могут влиять на возможность либо подключения к нашим облачным службам, либо управления паролями в локальной среде AD. Этот шаг рекомендуется выполнять только после попытки первые двух действий, описанных выше.

 1.	Загрузите новейшую версию Azure AD Connect [здесь](active-directory-aadconnect.md#install-azure-ad-connect).
 2.	Поскольку вы уже установили Azure AD Connect, будет достаточно выполнить обновление на месте, чтобы обновить установленный пакет Azure AD Connect до новейшей версии.
 3.	Запустите загруженный пакет и следуйте инструкциям на экране для обновления компьютера Azure AD Connect. Никакие дополнительные действия вручную выполнять не требуется, если только вы не настроили правила синхронизации «из коробки». В этом случае следует **создать их резервную копию перед продолжением обновления и вручную повторно развернуть их после завершения**.

Эти шаги позволяют восстановить подключение к нашей облачной службе и устранить возможные перебои в работе.

Если установка новейшей версии сервера Azure AD Connect не решила проблему, попробуйте отключить и повторно включить обратную запись паролей в качестве последнего шага после установки новейшей версии QFE синхронизации.

Если это не решило проблему, рекомендуется рассмотреть разделы [Устранение неполадок обратной записи паролей](#troubleshoot-password-writeback) и [Вопросы и ответы по управлению паролями Azure AD](active-directory-passwords-faq.md), чтобы узнать, обсуждается ли в них ваша проблема.


<br/> <br/> <br/>

## Ссылки на документацию по сбросу паролей
Ниже приведены ссылки на все страницы документации по службе сброса паролей Azure AD.

* **Вы здесь потому, что возникают проблемы при входе?** Если это так, [с помощью этих инструкций можно изменить и сбросить пароль](active-directory-passwords-update-your-own-password.md).
* [**Как работает служба**](active-directory-passwords-how-it-works.md) — узнайте, из каких шести компонентов состоит служба и за что отвечает каждый из них.
* [**Приступая к работе**](active-directory-passwords-getting-started.md) — узнайте, как предоставить пользователям возможность сбрасывать и менять свои облачные и локальные пароли.
* [**Настройка**](active-directory-passwords-customize.md) — узнайте, как настроить оформление и функциональность службы в соответствии с потребностями организации.
* [**Рекомендации**](active-directory-passwords-best-practices.md) — узнайте, как быстро развернуть службу и эффективно управлять паролями в организации.
* [**Аналитика**](active-directory-passwords-get-insights.md) — узнайте об интегрированных функциях отчетности.
* [**Часто задаваемые вопросы**](active-directory-passwords-faq.md) — ознакомьтесь с ответами на часто задаваемые вопросы.
* [**Дополнительные сведения**](active-directory-passwords-learn-more.md) — ознакомьтесь с технической стороной работы службы.



[001]: ./media/active-directory-passwords-troubleshoot/001.jpg "Image_001.jpg"
[002]: ./media/active-directory-passwords-troubleshoot/002.jpg "Image_002.jpg"
[003]: ./media/active-directory-passwords-troubleshoot/003.jpg "Image_003.jpg"
[004]: ./media/active-directory-passwords-troubleshoot/004.jpg "Image_004.jpg"

<!---HONumber=AcomDC_0817_2016-->
