<properties
   pageTitle="Настройка безопасных подключений, поддерживаемых кластером Service Fabric | Microsoft Azure"
   description="Узнайте о том, как использовать Visual Studio для настройки безопасных подключений, поддерживаемых кластером Azure Service Fabric."
   services="service-fabric"
   documentationCenter="na"
   authors="cawaMS"
   manager="paulyuk"
   editor="tglee" />

<tags
   ms.service="multiple"
   ms.devlang="dotnet"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="multiple"
   ms.date="10/08/2015"
   ms.author="cawaMS" />

# Настройка безопасных подключений к кластеру Service Fabric из Visual Studio

Узнайте, как использовать Azure Visual Studio для безопасного доступа к кластеру Service Fabric с настроенной политикой контроля доступа.

## Типы подключения кластера

Существует два типа подключений, поддерживаемых кластером Azure Service Fabric: **небезопасные** подключения и безопасные подключения **на основе сертификата x509**. (Для кластеров Service Fabric, размещенных локально, также поддерживается проверка подлинности **Windows** и **dSTS**.) Тип подключения кластера необходимо настроить при создании кластера. После создания изменить тип подключения нельзя.

Средства Service Fabric Visual Studio поддерживают все типы проверки подлинности для подключения к кластеру для публикации. Инструкции по настройке безопасного кластера Service Fabric см. в разделе [Настройка кластера Service Fabric на портале Azure](service-fabric-cluster-creation-via-portal.md).

## Настройка подключения кластера в профилях публикации

При публикации проекта Service Fabric из Visual Studio в диалоговом окне **Публикация приложения Service Fabric** можно выбрать кластер Azure Service Fabric, нажав кнопку **Выбрать** в разделе **Конечная точка подключения**. Вы можете войти в учетную запись Azure и выбрать существующий кластер в своих подписках.

![Диалоговое окно **Публикации приложения Service Fabric** позволяет настроить подключение к Service Fabric.][publishdialog]

Диалоговое окно **Выбор кластера Service Fabric** автоматически проверяет подключение кластера. Если проверка проходит успешно, это означает, что в системе установлены необходимые сертификаты для безопасного подключения к кластеру или то, что кластер не является безопасным. Неудачный результат проверки может быть вызван проблемами с сетью или неправильной настройкой системы для безопасного подключения к кластеру.

![Диалоговое окно **Выбор кластера Service Fabric** позволяет настроить существующее подключение к кластеру Service Cluster или создать новое подключение.][selectsfcluster]

### Безопасное подключение к кластеру

1.	Убедитесь, что вам доступен один из клиентских сертификатов, которым доверяет целевой кластер. Сертификат обычно распространяется в виде файла обмена персональной информацией (.pfx). Руководство по настройке доступа клиента к серверу см. в разделе [Настройка кластера Service Fabric на портале Azure](service-fabric-cluster-creation-via-portal.md).

2.	Установите доверенный сертификат. Для этого дважды щелкните PFX-файл или импортируйте сертификаты с помощью сценария PowerShell PfxCertificate. Установите сертификат в каталог **Cert:\\LocalMachine\\My**. При импорте сертификата можно принять все настройки по умолчанию.

3.	Выберите **Опубликовать...** в контекстном меню проекта, чтобы открыть диалоговое окно **Публикация приложения Azure**, а затем выберите целевой кластер. Средство автоматически разрешает подключение и сохраняет параметры безопасного подключения в профиле публикации.

4.	[Необязательно]: можно изменить профиль публикации, указав в нем безопасное подключение к кластеру.

    Так как вы добавляете информацию о сертификате в XML-файл профиля публикации вручную, запишите имя хранилища сертификатов, расположение хранилища и отпечаток сертификата. Эти значения нужно будет указать в качестве имени и расположения хранилища сертификатов. Для получения дополнительных сведений см. раздел [Руководство: получение отпечатка сертификата](https://msdn.microsoft.com/library/ms734695(v=vs.110).aspx).

    Параметры *ClusterConnectionParameters* позволяют задать параметры PowerShell для подключения к кластеру Service Fabric. Допустимы все значения параметров, которые принимаются командлетом Connect-ServiceFabricCluster. Список доступных параметров см. в разделе [Connect-ServiceFabricCluster](https://msdn.microsoft.com/library/mt125938.aspx).

    При публикации на удаленный кластер необходимо указать соответствующие параметры для этого конкретного кластера. Ниже приведен пример небезопасного подключения к кластеру:

    `<ClusterConnectionParameters ConnectionEndpoint="mycluster.westus.cloudapp.azure.com:19000" />`

    Ниже приведен пример для безопасного подключения к кластеру на основе сертификатов x509:

    ```
    <ClusterConnectionParameters
    ConnectionEndpoint="mycluster.westus.cloudapp.azure.com:19000"
    X509Credential="true"
    ServerCertThumbprint="0123456789012345678901234567890123456789"
    FindType="FindByThumbprint"
    FindValue="9876543210987654321098765432109876543210"
    StoreLocation="CurrentUser"
    StoreName="My" />
    ```

5.	Измените другие необходимые параметры, такие как параметры обновления и расположение файла параметров приложения, и снова опубликуйте приложение из диалогового окна **Публикация приложения Service Fabric** в Visual Studio.

## Дальнейшие действия
Дополнительные сведения о доступе к кластерам Service Fabric см. в разделе [Визуализация кластера с помощью обозревателя Service Fabric](service-fabric-visualizing-your-cluster.md).

<!--Image references-->
[publishdialog]: ./media/service-fabric-visualstudio-configure-secure-connections/publishdialog.png
[selectsfcluster]: ./media/service-fabric-visualstudio-configure-secure-connections/selectsfcluster.png

<!---HONumber=AcomDC_0114_2016-->